<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>1471-2105-11-S1-S54 1..11</title>
<meta name="Creator" content="Arbortext Advanced Print Publisher 9.0.220/W Unicode"/>
<meta name="Producer" content="Acrobat Distiller 8.1.0 (Windows)"/>
<meta name="CreationDate" content=""/>
</head>
<body>
<pre>
BMC Bioinformatics

BioMed Central

Research

Open Access

Estimating true evolutionary distances under rearrangements,
duplications, and losses
Yu Lin*, Vaibhav Rajan, Krister M Swenson and Bernard ME Moret*
Address: Laboratory for Computational Biology and Bioinformatics, Swiss Federal Institute of Technology (EPFL), EPFL-IIS-LCBB, INJ 230,
Station 14, CH-1015 Lausanne, Switzerland
E-mail: Yu Lin* - yu.lin@epfl.ch; Vaibhav Rajan - vaibhav.rajan@epfl.ch; Krister M Swenson - krister.swenson@epfl.ch;
Bernard ME Moret* - bernard.moret@epfl.ch
*Corresponding author

from The Eighth Asia Pacific Bioinformatics Conference (APBC 2010)
Bangalore, India 18-21 January 2010
Published: 18 January 2010
BMC Bioinformatics 2010, 11(Suppl 1):S54

doi: 10.1186/1471-2105-11-S1-S54

This article is available from: http://www.biomedcentral.com/1471-2105/11/S1/S54
© 2010 Lin et al; licensee BioMed Central Ltd.
This is an open access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/2.0),
which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

Abstract
Background: The rapidly increasing availability of whole-genome sequences has enabled the
study of whole-genome evolution. Evolutionary mechanisms based on genome rearrangements
have attracted much attention and given rise to many models; somewhat independently, the
mechanisms of gene duplication and loss have seen much work. However, the two are not
independent and thus require a unified treatment, which remains missing to date. Moreover,
existing rearrangement models do not fit the dichotomy between most prokaryotic genomes (one
circular chromosome) and most eukaryotic genomes (multiple linear chromosomes).
Results: To handle rearrangements, gene duplications and losses, we propose a new evolutionary
model and the corresponding method for estimating true evolutionary distance. Our model,
inspired from the DCJ model, is simple and the first to respect the prokaryotic/eukaryotic
structural dichotomy. Experimental results on a wide variety of genome structures demonstrate
the very high accuracy and robustness of our distance estimator.
Conclusion: We give the first robust, statistically based, estimate of genomic pairwise distances
based on rearrangements, duplications and losses, under a model that respects the structural
dichotomy between prokaryotic and eukaryotic genomes. Accurate and robust estimates in true
evolutionary distances should translate into much better phylogenetic reconstructions as well as
more accurate genomic alignments, while our new model of genome rearrangements provides
another refinement in simplicity and verisimilitude.

Page 1 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

Background
Introduction
Interest in the evolution of genome structure has been
growing steadily in the last 10 years, sustained in part by
the ever increasing number of sequenced genomes. In
particular much work has been done on rearrangements
(see, e.g., [1]), using the convention that each chromosome
of the genome is represented by an ordered list of
identifiers, each identifier referring to a syntenic block or,
more commonly, to a member of a gene family. (In the
following, we shall use the word “gene” in a broad sense to
denote elements of such orderings and refer to such
orderings as “gene orders”.) Variations in the placement of
homologous genes, as well as variations in gene content
and multiplicity, among organisms can then be analyzed.
Such data is of great interest to evolutionary biologists, but
also to comparative genomicists and to any researcher
interested in understanding evolutionary changes in
pathogens, crop plants, and, more generally, the biome.

The most fundamental task in the analysis of such data is to
estimate the amount of evolutionary change between two
genomes–that is, to compute a pairwise evolutionary distance.
The true distance, that is, the number of actual evolutionary
events (rearrangements, duplications, and losses) that took
place during the course of evolution, is what we want to
obtain, but is not, of course, something that we can
compute. Researchers have thus used a two-stage process, in
which a well defined measure is first computed (such as an
edit distance, that is, the smallest number of evolutionary
events needed to transform one genome into the other),
then a statistical model of evolution is used to infer an
estimate of the true distance by deriving the effect of a given
number of changes in the model on the computed measure
and (algebraically or numerically) inverting the derivation
to produce a maximum-likelihood estimate of the true
distance under the model. This second step is usually called
a distance correction and has long been used for sequence
(DNA) data (see, e.g., [2]) as well as, more recently, for geneorder data, for which see [3-7].
Evolutionary events that affect the gene order of genomes
include various rearrangements, which affect only the order,
and gene duplications and losses, which affect both the gene
content and, indirectly, the order. (Gene insertion, corresponding to lateral gene transfer or neofunctionalization,
can be viewed as a special case of duplication.) Rearrangements themselves include inversion, transposition, block
exchange, circularization and linearization, all of which act
on a single chromosome, and translocation, fusion, and
fission, which act on two chromosomes. All of these
operations are subsumed in the double-cut-and-join (DCJ)
[8,9], which has formed the basis for much of the
algorithmic research on rearrangements over the last few
years, including a statistically based method to estimate the

http://www.biomedcentral.com/1471-2105/11/S1/S54

true evolutionary distance between two genomes [7]. DCJ
makes two cuts, which can be in the same chromosome or
in two different chromosomes, producing four cut ends,
then rejoins the four cut ends in any of the three possible
ways. The DCJ model, however, is unrealistic in two major
respects. First, if the two cuts are in the same chromosome,
one of the two nontrivial rejoinings causes a fission, creating
a new circular chromosome. However, circular chromosomes do not normally arise in organisms with linear
chromosomes, and prokaryotic genomes normally consist
of a single circular chromosome. Nor can this form of
rejoining be forbidden as, without it, DCJ simply reduces to
inversion. Secondly, DCJ is a model of rearrangements: it
does not take into account evolutionary events that alter the
gene content, such as duplications and losses.
Of these two problems, the first has not been seriously
addressed: the model we present here is, to the best of our
knowledge, the first model that naturally preserves the
dichotomy between prokaryotic and eukaryotic genomes.
While gene (or segment) duplications and losses have long
been studied by geneticists and molecular biologist, their
integration with rearrangements in a unified model has seen
relatively little work to date. El-Mabrouk [10] gave an exact
algorithm to compute edit distances for inversions and
losses and also a heuristic to approximate edit distances for
inversions, losses, and nonduplicating insertions (all of her
results assume that genes cannot be duplicated). More
recently, Yancopoulos and Friedberg [11] gave an algorithm
to compute edit distances under deletions, insertions,
duplications, and DCJ operations, under the constraint
that each deletion can only remove a single gene. These and
other approaches targeted the edit distance, not the true
evolutionary distance. Swenson et al. [12] gave an algorithm
to approximate the true evolutionary distance under
deletions, insertions, duplications, and inversions for
unichromosomal genomes and showed good results
under simulations and for small-scale phylogenetic reconstruction. Rearrangements, duplications and losses have
also been addressed in the framework of ancestral
reconstruction (see, e.g., [13]). All of these approaches
have focused on parsimony criteria and have used preassigned weights for the various operations.
In this paper, we propose a new evolutionary model
which respects the dichotomy between prokaryotic and
eukaryotic genomes and which takes gene duplications
and losses into account. Using this new evolutionary
model, we develop a statistically based method to
estimate the true evolutionary distance in terms of the
actual number of rearrangements, gene duplications, and
gene losses. Finally, we provide extensive experimental
results on a wide variety of genome structures to
illustrate the robustness and high accuracy of our
estimator.

Page 2 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

Genomes as gene-order data
We denote the tail of a gene g by gt and its head by gh. We write
+g to indicate an orientation from tail to head (gt Æ gh), -g
otherwise (gh Æ gt). Two consecutive genes a and b can be
connected by one adjacency of one of the following four types:
{at, bt}, {ah, bt}, {at, bh}, and {ah, bh}. If gene c lies at one end
of a linear chromosome, then we also have a singleton set,
{ct} or {ch}, called a telomere. A genome can then be
represented as a multiset of genes together with a multiset
of adjacencies and telomeres. For example, the toy genome in
Figure 1, composed of one linear chromosome, (+a, +b, -c, +a,
+b, -d, +a), and one circular one, (+e, -f), can be represented by
the multiset of genes {a, a, a, b, b, c, d, e, f} and the multiset of
adjacencies and telomeres {{at}, {ah, bt}, {bh, ch}, {ct, at}, {ah,
bt}, {bh, dh}, {dt, at}, {ah}, {eh, fh}, {et, ft}}. Because of the
duplicated genes, there is no one-to-one correspondence
between genomes and multisets of genes, adjacencies, and
telomeres. For example, the genome composed of one linear
chromosome, (+a, +b, -d, +a, +b, -c, +a) and one circular one
(+e, -f) would have the same multisets of genes, adjacencies
and telomeres as that in Figure 1.
Preliminaries on the evolutionary model
We use two parameters: the probability of occurrence of a
gene duplication, pd, and the probability of occurrence of a
gene loss, pl; the probability of occurrence of a rearrangement is then just pr = 1 - pd - pl. The next event is chosen from
the three categories according to these parameters.

For rearrangements, we will select two adjacencies or
telomeres with replacement uniformly from the multiset
of all adjacencies and telomeres and then decide which
rearrangement event we apply. The four cases are as follows.
Select two different adjacencies, or one adjacency and one
telomere, in the same chromosome
For example, select two different adjacencies {a ih−1 , a it } and
{a h , a tj +1} on one linear chromosome C = (a1 ... ai-1ai ... ajaj
j
+1 ... an). Reversing all genes between ai and aj yields (a1 ...
ai-1 - aj ... -aiaj+1 ... an). Two adjacencies, {a ih−1 , a it } and
{a h , a tj +1} , are replaced by two others, {a ih−1 , a h} and
j
j
{a it , a tj +1} . This operation causes an inversion.

Figure 1
A very small genome G.

http://www.biomedcentral.com/1471-2105/11/S1/S54

Select two adjacencies or one adjacency and one telomere
in two different chromosomes
For example, select two adjacencies, {a ih , a it+1} from one
linear chromosome C = (a1 ... aiai+1 ... an) and {b h , b tj +1}
j
from another linear chromosome D = (b1 ... bjbj+1 ... bn).
Now exchange the two segments between these two
chromosomes C and D. There are two possible outcomes,
(a1 ... aibj+1 ... bn) and (b1 ... bjai+1 ... an) or (a1 ... ai - bj ... -b1)
and (-bn ... -bj+1ai+1 ... an). Two adjacencies, {a ih , a it+1} and
{b h , b tj +1} , are replaced by {a ih , b h+1} and {a it+1 , b tj} or
j
j
{a ih , b h} and {a it+1 , b tj +1} . This operation causes a transloj
cation (or, if at least one chromosome is circular, a fusion).
Select the same adjacency twice
For example, select the adjacency {a ih , a it+1} twice from
linear chromosome C = (a1 ... aiai+1 ... an). Then split C into
two new linear chromosomes, (a1 ... ai) and (ai+1 ... an). The
adjacency {a ih , a it+1} is replaced by two telomeres {a ih} and
{a it+1} . This operation causes a fission for a linear
chromosome, a linearization for a circular one.
Select two telomeres
(Selecting one telomere twice is assimilated to selecting both
telomeres of the linear chromosome.) For example, select
telomeres {a ih} and {b tj} from two different linear chromosomes. Then concatenate these two linear chromosomes into
a single new chromosome. Two telomeres, {a ih} and {b tj} ,
are replaced by two other telomeres, {a ih} and {b tj} . This
operation causes a fusion on two linear chromosomes or a
circularization on one linear chromosome.

For gene duplication, we uniformly select a position to
start duplicating a short segment of chromosomal material
and place the new copy to a new position within the
genome. We set Lmax as the maximum number of genes in
the duplicated segment and assume that the number of
genes in that segment is a uniform random number
between 1 and Lmax. For example, select one segment ai+1 ...
ai+L to duplicate and insert the copy between one adjacency
{b h , b tj +1} . Such an operation duplicates L genes and L - 1
j
adjacencies, removes one adjacency, and adds
two new adjacencies; thus genes ai+1,..., ai+L-1 and ai+L are
added to the multiset of genes, the adjacency
{b h , b tj +1} is removed, and L + 1 new adjacencies,
j
{b h , a it+1},{a ih+1 , a it+ 2}, … ,{a ih+ L , b tj +1} , are added.
j
For gene loss, we restrict deletions to genes with at least
two copies in the genome and we delete one gene at a
time. We uniformly select one gene from the set of all
candidate genes and delete it. For example, if we delete
gene ai in the chromosome (... ai-1aiai+1 ...), one copy of
ai is removed from the multiset of genes, while two
adjacencies, {a ih−1 , a it } and {a ih , a it+1} , are replaced by one
adjacency, {a ih−1 , d it+1} .

Page 3 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

Methods
An overview of our technique for estimating the true
evolutionary distance
The problem of estimating the true evolutionary distance
is defined as follows:

http://www.biomedcentral.com/1471-2105/11/S1/S54

adjacencies with exactly i copies in Gk that also appear in G,
DAk (distinct adjacencies) is the number of adjacencies in Gk
that do not appear in G, ST k (shared telomeres) is the
number of telomeres in Gk that also appear in G, and DT k
(distinct telomeres) is the number of telomeres in Gkthat do
not appear in G.

Input: The original genome G and the final genome F.
Output: An estimate of the actual number of evolutionary events that took place in the evolutionary history
to transform G into F.
Based on the multisets of genes and of adjacencies and
telomeres of G, for any genome G* of N* genes and l*
linear chromosomes, we can build the vector
∗
∗
∗
∗
V ∗ = (NG1 , … , NG C , SA1 , … , SA C , DA ∗ , ST ∗ , DT ∗ ) , where C
is the upper bound for the number of copies of one gene,
NG i∗ (i = 1,..., C) is the number of genes with exactly i
copies in the genome G*, SA i∗ (i = 1,..., C) is the number
of adjacencies with exactly i copies in G* that also appear
in G, DA* is the number of adjacencies in G* that do not
appear in G, ST * is the number of telomeres in G* that
also appear in G, and DT* is the number of telomeres in
G* that do not appear in G. We can write

N∗
N∗

C

=

∑ NG ,
i =1
C

=

∑ SA

∗
i

∗
i

+ DA ∗ + ST ∗ + DT ∗ − l ∗.

i =1

Let Gk be the genome obtained from G = G0 by applying
k randomly selected evolutionary operations–under
our model, the (i + 1)st evolutionary operation is
selected from all possible rearrangements, gene duplications, and gene losses on genome Gi according to
the parameters pd and pl. We can compute the vector
k
k
k
k
VG (G k ) = (NG1 , … , NG C , SA1 , … , SA C , DA k , ST k , DT k ) to
k
represent the genome G with respect to G.
In the section, we show that, given G, we can also produce
k
k
k
k
the estimate VG (G k ) = (NG1 ,… , NG C , SA1 ,… , SA C , DA k , ST k , DT k )
for the expected vector E(VG(Gk)), for any integer k > 0.
Our approach for estimating the true evolutionary distance
is then to return the integer k that minimizes the 1-norm
distance between VG (G k ) and VG(F).

Estimation of the expected vector after some number
of random evolutionary events
Given the original genome G, the complete vector for
k
k
genome Gk is defined as VG(G k ) = (NG1k , NG2 ,… , SA1k , SA 2 ,… , DA k , ST k , DT k ) ,
k is the number of genes with exactly i copies in
where NG i
the genome Gk, SA ik (shared adjacencies) is the number of

Assume the original genome G has N genes, where each
gene has at most C = O(1) copies, and l linear
chromosomes, with l = O(1). We thus ignore items NG ik
and SA ik for (i >C). The initial vector VG(G0) is then
0
0
0
0
0
0
(NG1 , NG 2 ,.., NG C , SA1 , SA 2 ,..., SA C , DA 0 , ST 0 , DT 0 ) , where
0 is the number of genes with exactly i copies,
NG i
SA i0
0
is the number of adjacencies with exactly i copies, DA = 0,
ST 0 = 2l, and DT0 = 0. We now show how to update this
vector under rearrangements, gene duplications and gene
losses, respectively.
Rearrangements
We select two adjacencies or telomeres uniformly with
replacement, from the multiset of all adjacencies or telomeres.

Theorem 1 Assume all genomes have O(1) linear chromosomes, each gene has at most C = O(1) copies, and
k
k
k
k
VG (G k ) = (NG1 , … , NG C , SA1 , … , SA C , DA k , ST k , DT k )
k
represents the current genome G based on the original
i
genome G. For conciseness, write N k = ∑ NG1 (the total
i =1
C

number of genes) and lk = (STk + DTk)/2 (the number of
linear chromosomes). Then we can write the expected
vector for G k+1 after one rearrangement operation:
k
k
k
k
E(VG (G k +1)) = (NG1 +1 ,..., NG C+1 , SA1 +1 ,..., SA C+1 , DA k +1 , ST k +1 , DT k +1)

where we have
NG ik +1 = NG ik , i = 1, 2,..., C
k
k
2i(SA i − SA i +1)
1
+ O(
SA ik +1 = SA ik −
), i = 1, 2,..., C − 1
k +l k
N
Nk
k
2C(SA C )
1
k
k
+ O(
),
SA C+1 = SA C −
k +l k
N
Nk
k
2(∑C 1 SA i )
1
i=
),
+ O(
DA k +1 = DA k +
k +l k
N
Nk
2ST k
1
)
ST k +1 = ST k −
+ O(
k +l k
N
Nk
2ST k
1
DT k +1 = DT k +
+ O(
).
k +l
N
Nk
k

Proof In our evolutionary model, each rearrangement
operation replaces old adjacencies or telomeres with new
ones. Obviously, any rearrangement operation will not
change the gene content, so NG ik+1 (i = 1,2,..., C) will be
the same.

Page 4 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

http://www.biomedcentral.com/1471-2105/11/S1/S54

We first ignore the adjacencies or telomeres in the original
genome G created after a rearrangement event. Remember
two adjacencies or telomeres are selected with replacement
uniformly from the multiset of all adjacencies and
telomeres, and the number of all adjacencies and telomeres
for genome Gk is (Nk +lk). Consider the multi-set Ai of SA ik
adjacencies with exactly i copies in Gk that also appear in G.
The probability that exactly one of the two selected
2SA ik ( N k + l k − SA ik )
( N k + l k )2

adjacencies is in Ai is

, the probability

that two different adjacencies from Ai are selected
is

SA ik (SA ik − i)
( N k + l k )2

, the probability that equivalent adjacencies

from Ai at different sites are selected is

(i −1)SA ik
( N k + l k )2

, and the

probability that some adjacency from Ai is selected twice is
SA ik
( N k + l k )2

. For the time-being we ignore adjacencies and

telomeres in G that may be created incidental. With
probability

2SA ik ( N k + l k − SA ik ) + iSA ik
( N k + l k )2
SA ik (SA ik − i)
( N k + l k )2

the number of adjacencies with

exactly i copies decreases by 2i. With probability
2SA ik ( N k + l k − SA ik ) + SA ik
( N k + l k )2

the number of adjacencies with

exactly (i -1) copies increases by (i -1), with probability
SA ik (SA ik − i)
( N k + l k )2

the number of adjacencies with exactly (i - 1)

copies increases by 2(i - 1), and with probability

(i −1)SA ik
( N k + l k )2

the number of adjacencies with exactly (i -2) copies increases
by (i -2). Considering i = 1,2,..., C and C = O(1), we have

SA ik +1

= SA ik −

k
k
2i(SA i − SA i +1)
, i = 1, 2,..., C − 1
N k +l k

k
SA C+1

k
= SA C −

k
2C(SA C )
,
N k +l k

DA k +1 = DA k +

(a, b). So, with probability at most

C2
k + l k )2
(N

, one

specific adjacency in G might be created by the
rearrangement. Summing up all the N - l adjacencies in
G, we see that the correction for ignoring the possible
1
newly created adjacencies or telomeres in G is O( k ) .
N

k
Similarly, we can get ST k +1 = ST k − 2ST k + O( 1k ) and
N k +l
N
k
DT k +1 = DT k + 2ST k + O( 1k ) .
k
N +l

N

Gene duplication
We select uniformly at random an integer between 1 and
Lmax (the maximum number of genes in the duplicated
segment), then select uniformly at random a position in
the genome where to start the duplication, then insert the
copy at another position selected uniformly at random.

the number of adja-

cencies with exactly i copies decreases by i, and with
probability

1
rearrangement event is O( k ) for each item. Consider
N
any adjacency (a, b) in G: we might recover it only if we
select two adjacencies or telomeres containing two genes
a and b. Since each gene has at most C copies in the
genome, there are at most C2 pairs of adjacencies or
telomeres that may lead to recovery of the adjacency

k
2(∑C 1 SA i )
i=
.
N k +l k

Now, we show that the correction for ignoring incidental
creation of adjacencies or telomeres in G after a

Theorem 2 Assume all genomes have O(1) linear chromosomes,
each gene has at most C = O(1) copies, no two duplicate genes
or adjacencies are within the segment to be duplicated, and
k
k
k
k
VG (G k ) = (NG1 , … , NG C , SA1 , … , SA C , DA k , ST k , DT k ) represents
k
the current genome G based on the original genome G. For
i
conciseness, write N k = ∑ NG1 (the total number of
i =1
C

genes), l k = (ST k +
chromosomes) and L =
of genes in a duplicated
expected vector for Gk+1

DT k )/2 (the number of linear
(Lmax + 1)/2 (the average number
segment). Then we approximate the
after one duplication operation with
k
k
k
k
E(VG (G k +1)) = (NG1 +1 ,..., NG C+1 , SA1 +1 ,..., SA C+1 , DA k +1 , ST k +1 , DT k +1) where we have
k
k
NG1 +1 = NG1 −

k
L(NG1 )
,
k
N

NG ik +1 = NG ik +

k
k
iL(NGi −1 − NGi )
, i = 2,..., C − 1
.
Nk

k
k
NG C+1 = NG C +

k
k
CL(NGC −1)+ L(NGC )
,
k
N

k
SA1 +1

SA ik +1
k
SA C+1

DA k +1

k
k
k
(L −1)SA1 SA1 − SA 2
1
−
+ O(
),
N k −l k
N k +l k
Nk
k
k
k
k
i(L −1)(SA i −1 − SA i ) i(SA i − SA i +1)
1
+ O(
= SA ik −
−
), i = 2,..., C − 1
N k +l k
Nk
N k −l k

k
= SA1 −

k
k
k
C(L −1)SA C −1 +(L −1)SA C C(SA C )
1
−
+ O(
),
k +l k
k −l k
N
Nk
N
k
k
C
(L −1)DA k ∑i =1 SA i + DA
1
= DA k +
),
+
+ O(
N k −l k
N k +l k
Nk
k
= SA C +

ST k +1

= ST k −

DT k +1

= DT k +

ST k
N k +l k
ST k
N k +l k

+ O(

1
Nk

+ O(

)

1
Nk

).

Page 5 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

http://www.biomedcentral.com/1471-2105/11/S1/S54

Proof In our model, we uniformly select a position to
start duplicating L genes and transpose it to one new
uniformly chosen position within the genome. The
expected number of genes or adjacencies with exactly i
copies within the duplicated segment is L(NG ik ) / N k or
(L − 1)SA ik /(N k − l k ) . The probability that the placement of the duplicated segment breaks one adjacency at
any specific site is 1/(Nk + lk).
We again first ignore the adjacencies or telomeres in the
original genome G created after a duplication event.
Since we assume that no two genes or adjacencies are the
same within the duplicated segment, we have
k
k
NG1 +1 = NG1 −

NG ik +1 =
k
NG C+1 =

k
SA1 +1

=

SA ik +1

=

k
SA C+1

=

DA k +1

=

k
L(NG1 )
,
Nk

k
k
iL(NGi −1 − NGi )
, i = 2,..., C − 1
.
NG ik +
k
N
k
k
CL(NGC −1)+ L(NGC )
k
NG C +
,
k
N
k
k
k
(L −1)SA1 SA1 − SA 2
k
−
,
SA1 −
k −l k
k +l k
N
N
k
k
k
k
i(L −1)(SA i −1 − SA i ) i(SA i − SA i +1)
, i = 2,..., C − 1
−
SA ik +
N k +l k
N k −l k
k
k
k
C(L −1)SA C −1 +(L −1)SA C C(SA C )
k
SA C +
−
.
N k +l k
N k −l k
k
k
C
(L −1)DA k ∑i =1 SA i + DA
DA k +
+
.
N k −l k
N k +l k

Now, we show that the correction for ignoring adjacen1
cies or telomeres after a duplication event is O( k ) to
N

each item SA ik+1 . Consider any adjacency (a, b) in G: we
might recover it if we move gene a next to gene b after the
duplication. Since each gene has at most C copies in the
genome, there are at most 2LC2 possible duplication
operations to recover that adjacency (a, b). There are
altogether Ω (L(Nk + lk)2) different duplication opera⎛
⎞
1
tions. So, with probability O ⎜
⎜ ( N k + l k )2 ⎟ , one specific
⎟
⎝
⎠
adjacency in G might be created by the duplication
event. Summing up all the N - l adjacencies in G, we see
that the correction for ignoring the newly created
1
adjacencies or telomeres in G is O( k ) .
N

k
Similarly, we can get ST k +1 = ST k − ST k + O( 1k ) and
k +l
N
N

DT

k +1

k

= DT −

ST k
N k +l k

+ O( 1k ) .
N

Gene loss
We uniformly select one gene with at least two copies
and delete it.

Theorem 3 Assume each gene has at most C = O(1) copies and
k
k
k
k
k
k
VG (G k ) = (NG1 , NG 2 ,..., NG C , SA1 , SA 2 ,..., SA C , DA k , ST k , DT k ) reprek
sents the current genome G based on the original genome
G. For conciseness, write N k = ∑ NG ik (the total number
i =1
C

of genes) and lk = (STk+ DTk)/2 (the number of linear
chromosomes). Then we can write the expected vector
for Gk+1after one rearrangement operation as
k
k
k
k
E(VG (G k +1)) = (NG1 +1 ,..., NG C+1 , SA1 +1 ,..., SA C+1 , DA k +1 , ST k +1 , DT k +1) ,
where we have

k
NG 2
,
k
N k − NG1
k
k
i(NGi − NGi +1)
= NG ik −
, i = 2,..., C − 1
k
N k − NG1

k
k
NG1 +1 = NG1 +

NG ik +1

k
k
NG C+1 = NG C −

k
C(NGC )
.
k
N k − NG1

Proof In our model of gene loss, one gene with at least
two copies is uniformly selected. The number of all
k
possible genes to be deleted is N k − NG1 . For
k
NG ik (i > 1) genes with exactly i copies in G , the
probability that one of them is selected and deleted is

NGik
N k − NGik

. So with probability

NGik
N k − NGik

, the number of

genes with exactly i copies decreases by i and the number
of genes with exactly (i -1) copies increases by (i -1).
We ignore the adjacencies or telomeres in the original
genome G to be created after one gene loss. For SA ik (i > 2)
adjacencies with exactly i copies in Gk which also appears
in G, it is difficult to compute the number fi(delj) of such
adjacencies that each single deletion delj (j = 1,..., Nk k
NG1 ) would affect. But we know that each adjacency with
exactly i (i > 2) copies must relate to two genes with more
than 2 copies, so we have

k
N k − NG1

∑ j =1

f i (del j ) = 2SA ik .

Considering i = 2,..., C and C = O(1), we have

k
k
2i(SA i − SA i +1)
, i = 2,.., C − 1
k
N k − NG1
k
2C(SA C )
k
.
= SA C −
k
N k − NG1

SA ik +1 = SA ik −
k
SA C+1

k
For SA1 adjacencies with exactly 1 copy in Gk that also
appears in G, it is also difficult to compute the number
f1(delj) of such adjacencies that each single deletion

Page 6 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

delj (j = Nk k
DSA1 (= ∑

k

N
j =1

k
− NG1

http://www.biomedcentral.com/1471-2105/11/S1/S54

k
NG1 ) w o u l d a f f e c t . A s s u m e

f1(del j )) is the count of genes with at

least two copies but related to those adjacencies with exactly
1 copy in Gk that also appear in G. We consider the effect of
rearrangements, gene duplications and losses, and we
approximate as follows:
k
k
DSA1 +1 = DSA1 + p r

k
k
k
k
k
k
2(2SA 2 − DSA1 )
2SA1 − 2DSA1 + 2SA 2 ) (L −1)DSA1
−
)
+ pd(
N k +l k
N k −l k
N k +l k

k
k
k
k
2SA 2 − DSA1 (1+ NG 2 /(N k − NG1 )
,
k − NG k
N
1
k
k
DSA1 − 2SA 2
k
= SA1 − p l
.
k
N k − NG1
+pl

k
SA1 +1

For telomeres, we simply assume ST
DT k+1 = DT k.

k+1

= ST

k

and

Finally, we also approximate the number of adjacencies
RSAk+1 that we could thus ignore under rearrangements,
gene duplications, and gene losses, and distribute it to
the correction of SA ik as follows:

1
p d )(N − l)(N k / N ) 2 /(N k + l k ) 2
2
= SA ik + RSA k +1SA ik /(N k − l k − DA k ),

RSA k +1 = (p r +
SA ik +1

i = 1,..., C − 1.
Now, given G0, we estimate E(VG(Gk)) for k > 0 by
iterating k times the above formulas (using with pd and
pl); at every step we identify E(VG(Gk-1)) with the actual
vector VG(Gk-1).
Corollary
i

1

The

estimated

vector

i
i
i
i
(NG1 , … , NG C , SA1 , … , SA C , DA i , ST i , DT i ) f

or
VG (G ) =
all integers i (0 ≤ i ≤ k) can be computed in O(kC) time.

Results and discussion
We now present experimental results on the accuracy of
our estimation of the expected vector after a given
number of random evolutionary events and on the
quality of our estimator for the true evolutionary
distance (in terms of the actual number of evolutionary
events). Our experiments all start with one genome with
no duplicated genes and some chosen number of linear
and circular chromosomes of various sizes. We first
apply some number (usually 10) of duplication events
(Lmax = 10 in all cases) to generate the original genome G
with some initial duplicated genes. Then this genome is
subjected to a prescribed number k of evolutionary
events chosen according to pd and pl to obtain a final
genome Gk. We vary k from 0 to twice the number of
genes. We ran tests on any types of initial genomes
designed to resemble actual organismal genomes; we

tested different choices of parameters on different
genomes; and in each case we generated 10,000 runs to
obtain a tight estimate of variance.
We compute the vector representations for all intermediate genomes and then use our method to estimate
the evolutionary distance. Due to space limitations, we
present results on just three initial genomes: 25,000
genes and 25 linear chromosomes (pd = 0.05, pl = 0.15);
10, 000 genes and 5 linear chromosomes (pd = 0.1, pl =
0.2); and 1, 000 genes and 1 circular chromosome (pd =
0.2, pl = 0.6). The first two examples match large and
smaller metazoan genomes, the last matches a small
bacterial genome.
Accuracy of the expected vector after k random
evolutionary events
We study the behavior of our estimator VG (G k ) by
comparing its prediction to the sample mean for VG(Gk),
as computed from our 10,000 trials. In all of our
experiments, we find that VG (G k ) is very close to the
sample mean for VG(Gk). Figure 2 shows the values in
the vector as a function of the actual number of
k
k
evolutionary events. SA 3 and NA 3 represent the
number of adjacencies and genes with at least 3 copies
in the original genome G, respectively. The figure shows
that our estimation and the sample mean for VG(Gk) are
always very close.
Accuracy of the estimation of the actual number of
evolutionary events
We want to study the accuracy of our estimator for the
actual number of evolutionary events; in order to do that,
we create simulations with controlled numbers of evolutionary events and set up a threshold for correction in the
estimation procedure. Specifically, we vary the actual
number of evolutionary events from 0 to twice the number
of genes in the original genome and we set 4 times the
number of genes as an upper limit on the maximum
number of evolutionary events. C is set to 10. Thus our
estimated number k is chosen to minimize | VG (G k ) VG(F)|1, the 1-norm distance between VG (G k ) and VG(F).

Figure 3 shows the mean and standard deviation for the
actual number of evolutionary events estimated by our
approach. Our approach provides accurate estimates,
with very small variance.
We also study the mean absolute difference between the
actual number of evolutionary events and our estimator,
shown in Figure 4.
Table 1 shows that the estimates are quite accurate up to
very large numbers of events. Rearrangements, gene

Page 7 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

http://www.biomedcentral.com/1471-2105/11/S1/S54

Figure 2
The vector values as a function of the actual number of evolutionary events. (a) the color and shape code for the
values, (b) Gene # = 1,000, Linear Chromosome # = 0, Circular Chromosome # = 1, (c) Gene # = 10,000, Linear
Chromosome # = 10, Circular Chromosome # = 0, (d) Gene # = 25,000, Linear Chromosome # = 25, Circular Chromosome
# = 0.

duplications, and gene losses fall under the category of
“rare genomic events” (in the terminology of [14]), yet
our estimator works well even for numbers that would
instead indicate common events.

resolution, pd < 4pl) and with actual numbers of
evolutionary events varying from 0 to twice the number
of genes, setting an upper limit of 4 times the number
genes for the maximum number of evolutionary events.

Robustness to unknown model parameters
Up to now we have fixed pd and pl. We now consider the
case in which these parameters are unknown–clearly the
more common case in practice. We generate 10,000 cases
with randomly chosen parameters pd and pl (at 1%

Given the original genome, our estimated vector VG (G i )
is in fact a function of i, pd, and pl. We enumerate all
possible values for pd and pl (at 1% resolution, pd < 4 pl).
For each different pair of parameters pd and pl, we
compute all VG (G i ) (i from 0 to 4 times the number of

Page 8 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

http://www.biomedcentral.com/1471-2105/11/S1/S54

Figure 3
The actual number of evolutionary events (x axis)vs. our estimator (y axis). (a) Gene # = 1000, Linear Chromosome
# = 0, Circular Chromosome # = 1, (b) Gene # = 10000, Linear Chromosome # = 10, Circular Chromosome # = 0, (c) Gene #
= 25000, Linear Chromosome # = 25, Circular Chromosome # = 0. Mean is indicated by × and standard deviation is indicated
by vertical bar.

genes, C is set to 10). Our estimated number k is still
chosen to minimize | VG (G k ) - VG(F)|1, the 1-norm
distance between VG (G k ) and VG(F).
Figure 5 shows the comparison of our estimates to the
actual number of evolutionary events. Our approach still
provides accurate estimates in absence of known values
for pd and pl and thus is quite robust. The mean absolute
difference between the actual number of evolutionary
events and our estimator becomes larger, especially
when there are few common adjacencies left between

the original and final genomes. (The duplications and
losses may also partially cancel each other.)

Conclusion
We propose a new evolutionary model for rearrangements, gene duplications and losses, and a corresponding method for estimating true evolutionary distance.
The model is, to our knowledge, the first to preserve the
structural dichotomy in genomic organization between
most prokaryotes and most eukaryotes, and one of the
few to unite rearrangements, duplications, and losses.

Page 9 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

http://www.biomedcentral.com/1471-2105/11/S1/S54

Figure 4
The mean absolute difference between actual number of different evolutionary events and our estimation. The
actual number of evolutionary events (x axis) vs. The mean absolute difference between actual number of different
evolutionary events and our estimation (y axis). (o: Rearrangements, +: Duplications, ×: Losses). (a) Gene # = 1000, Linear
Chromosome # = 0, Circular Chromosome # = 1, (b) Gene # = 10000, Linear Chromosome # = 10, Circular Chromosome #
= 0, (c) Gene # = 25000, Linear Chromosome # = 25, Circular Chromosome # = 0.

Table 1: Relative error of our estimator as a function of the actual number of evolutionary events

# genes

actual number of evolutionary events
# genes × 1

# genes × 2

Rearrangements
1000
10,000
25,000

Duplications

Losses

Rearrangements

Duplications

Losses

7.4%
1.7%
1.3%

3.4%
1.4%
1.5%

7.4%
2.7%
2.0%

6.9%
2.6%
2.6%

3.4%
1.4%
1.5%

6.9%
3.1%
2.9%

Page 10 of 11
(page number not for citation purposes)

BMC Bioinformatics 2010, 11(Suppl 1):S54

http://www.biomedcentral.com/1471-2105/11/S1/S54

Figure 5
The actual number of evolutionary events vs. our estimator for unknown model parameters. (a): Mean (indicated
by ×) and standard deviation (indicated by vertical bar) plots for the actual number of evolutionary events vs. our estimator
(Gene # = 1000, Linear Chromosome # = 0, Circular Chromosome # = 1). (b): The mean absolute difference between actual
number of different evolutionary events and our estimation (o: Rearrangements, +: Duplications, ×: Losses).

Experimental results on a wide variety of genome
structures exemplify the high accuracy and robustness
of our estimator. This large gain in accuracy should
translate into much better phylogenetic reconstructions
as well as more accurate genomic alignments.

4.

5.

6.

Competing interest
The authors declare that they have no competing
interests.

Authors’ contributions
YL conceived the idea, performed the analysis. YL, VR
and KMS discussed and conducted the experiments.
BMEM directed the project. YL and BMEM wrote the
manuscript. All authors read and approved the final
manuscript.

7.
8.
9.

10.

Acknowledgements

11.

This article has been published as part of BMC Bioinformatics Volume 11
Supplement 1, 2010: Selected articles from the Eighth Asia-Pacific
Bioinformatics Conference (APBC 2010). The full contents of the
supplement are available online at http://www.biomedcentral.com/14712105/11?issue=S1.

12.

13.

References
1.
2.
3.

Fertin G, Labarre A, Rusu I, Tannier E and Vialette S: Combinatorics of
Genome Rearrangements MIT Press; 2009.
Swofford D, Olsen G, Waddell P and Hillis D: Phylogenetic
Inference. Molecular Systematics Sinauer Assoc., Sunderland, MA:
Hillis D, Mable B, Moritz C 1996, 407–514.
Moret B, Tang J, Wang LS and Warnow T: Steps toward accurate
reconstructions of phylogenies from gene-order data.
J Comput Syst Sci 2002, 65(3):508–525.

14.

Sankoff D and Blanchette M: Probability models for genome
rearrangement and linear invariants for phylogenetic inference. Proc 3rd Conf Research Comput Mol Biol (RECOMB’99) ACM
Press, New York; 1999, 302–309.
Wang LS: Exact-IEBP: a new technique for estimating
evolutionary distances between whole genomes. Proc 33rd
ACM Symp Theory of Comput (STOC’01) ACM Press, New York; 2001,
637–646.
Wang LS and Warnow T: Estimating true evolutionary
distances between genomes. Proc 1st Workshop Algs in Bioinformatics (WABI’01) Lecture Notes in Comp. Sci., Springer Verlag,
Berlin; 2001, 2149:176–190.
Lin Y and Moret B: Estimating true evolutionary distances
under the DCJ model. Proc 16th Conf Intelligent Systems for Mol Biol
(ISMB’08), Bioinformatics 2008, 24(13):i114–i122.
Yancopoulos S, Attie O and Friedberg R: Efficient sorting of
genomic permutations by translocation, inversion and block
interchange. Bioinformatics 2005, 21(16):3340–3346.
Bergeron A, Mixtacki J and Stoye J: A unifying view of genome
rearrangements. Proc 6th Workshop Algs in Bioinformatics (WABI’06)
Lecture Notes in Comp. Sci., Springer Verlag, Berlin; 2006,
4175:163–173.
El-Mabrouk N: Genome rearrangement by reversals and
insertions/deletions of contiguous segments. Proc 11th Symp
Combin Pattern Matching (CPM’00) Lecture Notes in Comp. Sci.,
Springer Verlag, Berlin; 2000, 1848:222–234.
Yancopoulos S and Friedberg R: Sorting genomes with insertions, deletions and duplications by DCJ. Proc 6th RE-COMB
Workshop Comp Genomics (RECOMBCG’08) Lecture Notes in Comp.
Sci., Springer Verlag, Berlin; 2008, 5267:170–183.
Swenson K, Marron M, Earnest-DeYoung J and Moret B: Approximating the true evolutionary distance between two genomes. Proc 7th SIAM Workshop Alg Engin & Experiments (ALENEX’05)
SIAM Press, Philadelphia; 2005, 121–129.
Ouangraoua A, Boyer F, McPherson A, Tannier E and Chauve C:
Prediction of contiguous regions in the amniote ancestral
genome. Proc 5th Int’l Symp on Bioinformatics Research and
Applications, (ISBRA’09) Lecture Notes in Comp. Sci., Springer Verlag,
Berlin; 2009, 5542:173–185.
Rokas A and Holland P: Rare genomic changes as a tool for
phylogenetics. Trends in Ecol and Evol 2000, 15:454–459.

Page 11 of 11
(page number not for citation purposes)

</pre>
</body>
</html>
