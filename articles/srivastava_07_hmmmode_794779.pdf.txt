<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>1471-2105-8-104.fm</title>
<meta name="Author" content="petere"/>
<meta name="Creator" content="FrameMaker 7.0"/>
<meta name="Producer" content="Acrobat Distiller 7.0 (Windows)"/>
<meta name="CreationDate" content=""/>
</head>
<body>
<pre>
BMC Bioinformatics

BioMed Central

Open Access

Methodology article

HMM-ModE – Improved classification using profile hidden Markov
models by optimising the discrimination threshold and modifying
emission probabilities with negative training sequences
Prashant K Srivastava†, Dhwani K Desai†, Soumyadeep Nandi and
Andrew M Lynn*
Address: School of Information Technology, Jawaharlal Nehru University, New Delhi, India
Email: Prashant K Srivastava - prashant.k.srivastava@gmail.com; Dhwani K Desai - dhwanidesai@gmail.com;
Soumyadeep Nandi - soumyadeep.nandi@gmail.com; Andrew M Lynn* - andrew@mail.jnu.ac.in
* Corresponding author †Equal contributors

Published: 27 March 2007
BMC Bioinformatics 2007, 8:104

doi:10.1186/1471-2105-8-104

Received: 21 August 2006
Accepted: 27 March 2007

This article is available from: http://www.biomedcentral.com/1471-2105/8/104
© 2007 Srivastava et al; licensee BioMed Central Ltd.
This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/2.0),
which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

Abstract
Background: Profile Hidden Markov Models (HMM) are statistical representations of protein families
derived from patterns of sequence conservation in multiple alignments and have been used in identifying
remote homologues with considerable success. These conservation patterns arise from fold specific
signals, shared across multiple families, and function specific signals unique to the families. The availability
of sequences pre-classified according to their function permits the use of negative training sequences to
improve the specificity of the HMM, both by optimizing the threshold cutoff and by modifying emission
probabilities to minimize the influence of fold-specific signals. A protocol to generate family specific HMMs
is described that first constructs a profile HMM from an alignment of the family's sequences and then uses
this model to identify sequences belonging to other classes that score above the default threshold (false
positives). Ten-fold cross validation is used to optimise the discrimination threshold score for the model.
The advent of fast multiple alignment methods enables the use of the profile alignments to align the true
and false positive sequences, and the resulting alignments are used to modify the emission probabilities in
the original model.
Results: The protocol, called HMM-ModE, was validated on a set of sequences belonging to six subfamilies of the AGC family of kinases. These sequences have an average sequence similarity of 63% among
the group though each sub-group has a different substrate specificity. The optimisation of discrimination
threshold, by using negative sequences scored against the model improves specificity in test cases from an
average of 21% to 98%. Further discrimination by the HMM after modifying model probabilities using
negative training sequences is provided in a few cases, the average specificity rising to 99%. Similar
improvements were obtained with a sample of G-Protein coupled receptors sub-classified with respect to
their substrate specificity, though the average sequence identity across the sub-families is just 20.6%. The
protocol is applied in a high-throughput classification exercise on protein kinases.
Conclusion: The protocol has the potential to maximise the contributions of discriminating residues to
classify proteins based on their molecular function, using pre-classified positive and negative sequence
training data. The high specificity of the method, and increasing availability of pre-classified sequence data
holds the potential for its application in sequence annotation.

Page 1 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

Background
Protein homology is used as the basis for studying its phylogeny and predicting its function. A preliminary step in
annotation of protein function from its sequence, is to
compare it against a database of functionally annotated
sequences and infer function based on similar conservation patterns to known homologues. As databases of
sequences with known functions are large, fast heuristic
methods based on extending local alignments such as
BLAST [1] and FASTA [2] are commonly employed for this
task.
Improved sensitivity in detecting homologues is provided
by profile-sequence comparison methods such as PSIBLAST[3] – which uses position specific scoring matrices,
and HMMER[4] which uses a profile Hidden Markov
Model (HMM). A profile is developed from a multiple
alignment and contains more information on the
sequence family than a single sequence, providing a base
for detecting homologs with discontinuous conservation
patterns, and remote homologues.
Patterns of sequence conservation can arise from both
phylogenetic and functional relationships between proteins [5]. Proteins perform a wide variety of functions, but
share a comparatively small number of folds. The TIMbarrel fold, as an extreme example, includes oxidoreductases, lyases, hydrolases and isomerases, which are examples of divergent evolution of function within the fold [6].
These proteins, while within each class contain functionspecific signals, share fold-specific signals across the functional groups. The development of profile-profile based
methods, (e.g. HHSEARCH [7], COACH [8]) maximises
the contribution of common signals between profiles,
providing even greater sensitivity in detecting remote
homologs, and have proven useful for fold classification.
Profile HMM databases are now commonly used to assign
a protein to a structural class: the Superfamily database[9]
which maps profiles to SCOP[10] structures, and the
Pfam database[11] – which is a database of protein families largely based on domains.
An important goal of sequence annotation is the ability to
assign molecular function to a protein sequence. Phylogenomic inference attempts to annotate protein function
in the context of its entire family, and though has
improved accuracy and specificity, its universal applicability is hampered by the fact that it is a labor-intensive manual process that requires significant effort from dedicated
scientists [12]. Sjolander and co-workers have used "subfamily HMMs", built from a multiple alignment of the
protein family decomposed into functionally distinct subfamilies, in classifying sequences with a very low error rate
[13].

http://www.biomedcentral.com/1471-2105/8/104

As sequences are increasingly being classified on the basis
of their common function – e.g the Gene Ontology
project [14] (see ref [12] for more examples), function
specific profiles are important goals in the ability to annotate sequences. HMMs built from a functionally classified
sub-family often pick up sequences belonging to other
sub-families because of fold signals common to the family. Pre-classified data however, provides for the use of
both positive and negative training sequences. Negative
training sequences have been used before, both to modify
emission probabilities [15] and transition probabilities
[16]. Both methods employ the Viterbi algorithm to align
negative training sequences to the model, and change its
probabilities during the training stage. Hannehalli and
Russell [17] have used positional entropy to assess the discerning value of an amino acid position in a multiple
alignment, sub-classify sequences, and score sequences
against HMMs to remove the influence of non-discriminating residues. Kernel based methods, notably the Support Vector Machine (SVM) have been applied to classify
sequences both at the fold level[18] and at the sub-family
level[19].
A multiple alignment of representative protein kinase
sequences divided into sub-families is illustrative of the
problem faced in using the HMM of a sub-family for classification (Figure 1). Easily apparent are the large number
of columns which are conserved across all sub-families,
representative of the fold signals. Amino acids selectively
conserved in one sub-family are responsible for its specific
function, and this information is used to discriminate
sequences from the other sub-families. G-protein coupled
receptors (GPCR) have also been classified hierarchically
[20] and have been used to test the application of kernel
based support vector machines as classifiers. This dataset
provides another test for discriminating methods – they
share a common fold but with limited sequence similarity
across the family. As the HMM built from a family of
sequences contains both common fold and function specific signals, the availability of a negative sequence data set
allows the use of methods that optimise the discrimination threshold to separate sequences based on their function. Further separation, if necessary, maybe provided by
modifying model parameters to minimize the influence
of fold-specific signals and/or maximise the influence of
specificity determining residues. These methods could be
applied to classify proteins on the basis of their function
in spite of their sharing a common fold.
We describe the use of cross-validation [21] to optimise
the threshold to improve specificity for a particular subfamily profile HMM. From different measures of estimating classification accuracy, we choose the mode of the
Matthews Correlation Coefficient (MCC) [22] distribution as the optimal threshold (referred henceforth in the

Page 2 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

PKA_200367
PKA_14758310
PKA_4322296
PKA_3123587
PKA_6679467
PKA_85121
PKA_157220
PKA_7512016
PKA_2144416
PKA_9844082
2f7z_E
GRK_3005003
GRK_3004994
GRK_3005005
GRK_4885347
GRK_4506529
GRK_6755326
GRK_12862627
GRK_13096806
GRK_5139484
GRK_345763
2BCJ_A
PKC_125551
PKC_55132
PKC_125548
PKC_104167
PKC_206189
PKC_4885563
PKC_11968080
PKC_35501
PKC_7434269
PKC_15074866
1xjd_A
RAC_400112
RAC_14750246
RAC_15296800
RAC_13928778
RAC_4885549
RAC_6753032
RAC_15296798
RAC_4502023
RAC_1079127
RAC_11260035
1mry_A
S6PK_1362152
S6PK_7434394
S6PK_14766240
S6PK_125691
S6PK_6065881
S6PK_13592065
S6PK_401774
S6PK_11181910
S6PK_4759052
S6PK_14748854
1vzo_A
PVPK_15219539
PVPK_15241076
PVPK_7446383
PVPK_8467992
PVPK_15128235
PVPK_15231840
PVPK_3435279
PVPK_541825
PVPK_6006312
PVPK_7446368

110
RF
RF
RF
SF
SF
SF
NF
NF
RF
RF
RF
GF
GF
GF
GF
NP GF
NP GF
GI
VF
VF
VF
VF
KF
KF
KF
KF
RF
KF
KL
KL
KL
AF
KF
VF
VF
VF
VF
VF
VF
VF
VF
I F
TF
VF
L F
I F
I F
MF
MF
MF
MF
L F
RF
RF
RF
CL
RF
FF
HF
RF
RL
RL
I F
VL
VL

http://www.biomedcentral.com/1471-2105/8/104

1
10
20
Q F D R I K T L G T G S F G R V ML V K H K E
ML V K H K E
D F D R I K T L G T G S F G R V ML V Q H K Q
NL E I I A T L GV GGF GRV E L V K V K N
NL E I I A T L GV GGF GRV E L V K V K N
DL E V V S T L GI GGF GRV E L V K A HH
DL RV I A T L GV GGF GRV E L V QT NG
DL RV I A T L GV GGF GRV E L V QT NG
DF QI L RT L GT GS F GRV HL I RS RH
DF QI L K L I GK GT F GQV Y QV RK K
Q F E R I K T L G T G S F G R V ML V K H ME
T F RQY RV L GK GGF GE V CA CQV R
T F RQY RV L GK GGF GE V CA CQV R
T F RQY RV L GK GGF GE V CA CQV R
T F RHY RV L GK GGF GE V CA CQV R
WF L D F R V L G K G G F G E V S A C Q M K
WF L D F R V L G K G G F G E V S A C Q M K
Y F Y E F RT L GK GGF GE V CA V QV K
DF S V HRI I GRGGF GE V Y GCRK A
E F S V HRI I GRGGF GE V Y GCRK A
E F S V HRI I GRGGF GE V Y GCRK A
DF S V HRI I GRGGF GE V Y GCRK A
D F N F L MV L G K G S F G K V ML A D R K
D L N F L MV L G K G S F G K V ML A D R K
D F N F L MV L G K G S F G K V ML A D R K
D F S F L MV L G K G S F G K V MV G R R K
D F N F L MV L G K G S F G K V ML S E R K
E F N F I K V L G K G S F G K V ML A E L K
DF DL I RV I GRGS Y A KV L L V RL K
DF DL I RV I GRGS Y A KV L L V RL K
DF RL L T V I GRGS Y A KV V QA E HV
H F N F L A V L G K G N F G K V ML A E T K
D F I L H K ML G K G S F G K V F L A E F K
E F E Y L KL L GK GT F GKV I L V K E K
E F E Y L KL L GK GT F GKV I L V K E K
DF DY L KL L GK GT F GKV I L V RE K
DF DY L KL L GK GT F GKV I L V RE K
DF DY L KL L GK GT F GKV I L V RE K
DF DY L KL L GK GT F GKV I L V RE K
DF DY L KL L GK GT F GKV I L V RE K
DF DY L KL L GK GT F GKV I L V RE K
NF E F L KV L GK GT F GKV I L CRE K
DF DF L KV L GQGT F GKV I L CRE K
DF DY L KL L GK GT F GKV I L V RE K
N F E V L K L V G Q G A F G K V Y Q V R MK
CF E L L RV L GK GGY GKV F QV RK V Q
CF E L L RV L GK GGY GKV F QV RK V Q
HF
QF
QF
NF
NF
NF
DF
HF
HF
HF
HF
HL
HF
HF
HF
HF

SEPHARF
SEPHARF
SEPHARF
DEPT SKF
DEPT SKF
E DNA A QF
DDST T RF
DDST T RF
PNPVAKF
DE QRA K F
SEPHARF
PEARAVF
PEARAVF
PEARAVF
DE QRA V F
PEPRAL F
SEPRAI Y
E ME R I I Y
S E A D MR F
S E K E MR F
S E K E MR F
S E A D MR F
K E P QA V F
K E P QA V F
K E P QA V F
K E P QA V F
KEPHAVF
DEPRSRF
PEEHARF
PEEHARF
PEEHARF
GS RRA QF
DL SRAT F
SEDRARF
SEDRARF
SEDRT RF
SEDRT RF
SEDRT RF
SEDRT RF
SEDRT RF
T EERARF
T EDRT RF
SEART RF
T EERARF
REEL ARI
L EDT ACF
L EDT ACF
T EEDVKF
T EEDVKF
T EEDVKF
T EEDVKF
T EEDVKF
T E HE V QI
T E HE V QI
T E HE V QI
DEEI ARI
T E QA A K F
PEHAARF
NE QA A RF
T VSST RF
P I QP V RF
PI SPVRF
KEESARF
HEDAVRF
KEDSVRF
130

EL
EL
EL
EL
EL
EL
EI
RL
RL
RL
RL
KL
KL
NP
RP
RP

L
L
L
L
L
L
I
L
L
L
V
I
V
I
V
I

K V L GQGS F
K V L GQGS F
K V L GQGS F
K V L GT GAY
K V L GT GAY
K V L GT GAY
K P I S RGAF
K RL GCGDI
K RL GCGDI
K RL GY GDI
RRL GS GDL
RHL GT GNL
RHL GT GNL
K P L GCGDT
K P L GS GDT
K P L GS GDT
50

120
Y A A QI
Y A A QI
Y GA QI
CVACV
CVACV
I I GCV
YT ACV
YT ACV
YAAEV
YI AEL
Y A A QI
YAAEI
YAAEI
YAAEI
YAAEL
Y T A QI
Y T A QI
Y T A QI
YAAEI
YATEI
YATEI
YAAEI
YAAEI
YAAEI
YAAEI
YAAEI
YAAEI
YAAEV
YAAEI
YAAEI
Y S GE I
YAAEV
YAAEI
Y GA E I
Y GA E I
Y GA E I
Y GA E I
Y GA E I
Y GA E I
Y GA E I
Y GA E I
Y GA E I
Y GS E I
Y GA E I
YTAEI
YL AEI
YL AEI
YL AEL
YL AEL
YL AEL
YL AEL
YL AEL
Y V GE I
Y V GE I
Y V GE I
YI AEL
YVAEV
YVAEV
YASEV
YVAET
FAAEV
FAAEV
YAAEV
YAAEV
YAAEV

GKV
GKV
GKV
GKV
GKV
GKV
GKV
GT V
GS V
GS V
GNV
GRV
GRV
GS V
GS V
GS V

F L VRK
FL VKK
F L VRK
F L VRK
F L VRK
F L VRK
F L ARK
HL AEL
FLAEL
YLVEL
YL CRL
F L CNL
F L CHL
HL VEL
HL VEL
HL VEL
60

130
VL T F EYL HSL D L
VL T F EYL HSL D L
V L A F QY L HS L D L
T EAF DYL HRL G I
T EAF DYL HL L G I
L QA F E Y L HA RG I
VEAF DYL HSRN I
VEAF DYL HSRN I
CL AL EYL HSKD I
I L AL EHL HKHD I
VL T F EYL HSL D L
CCGL E DL HRE R I
CCGL E DL HRE R I
CCGL E DL HRE R I
CCGL E DL QRE R I
I CGL E HL HQRR I
I S GL E HL HQRR I
T T G ML Q L H N MD I
I L G L E H MH N R F V
I L G L E H MH N R F V
I L GL E HV HNRF V
I L G L E H MH N R F V
S I GL F F L HK RG I
S I GL F F L HK RG I
S I GL F F L HK RG I
S V GL F F L HK K G I
A I GL F F L QS K G I
T S A L MF L H Q H G V
CI AL NF L HERG I
CI AL NF L HERG I
I L AL HF L HSRG I
CL AL KYF HENG V
I L GL QF L HS K G I
VSAL DYL HSEKNV
VSAL DYL HSEKNV
V S AL DY L HS GK I
V S AL DY L HS GK I
V S AL DY L HS GK I
V S AL DY L HS GK I
V S AL DY L HS GK I
VSAL EYL HSRD V
I S AL GY L HS QG I
I L AL GY L HHRN I
VSAL EYL HSRD V
VSAVAHL HANG I
T L A L GHL HS QG I
T L A L GHL HS QG I
AL AL DHL HSL G I
AL AL DHL HSL G I
A L GL DHL HS L G I
AL AL DHL HSL G I
A L A L DHL HQL G I
VL AL EHL HKL G I
VL AL EHL HKL G I
VL AL EHL HKL G I
VL AL EYL HSL K I
L L A ME Y L H ML G I
L L A L E Y L H ML G I
L L A L E Y L H ML G I
V L A L E Y L H MMG V
L V A L E Y L H A MG I
L VAL EYL HAL G I
V I GL E Y L HCL G I
V V A L E Y L HCQG I
VI AL EYL HCL G I
140

30
G
NHY
G
NHY
K
DYF
N
VAF
N
VAF
DRVDI F
SS RSF
SS RSF
G
RYY
DT KRI Y
G
NHY
A T G K MY
A T G K MY
A T G K MY
A T G K MY
A T GK L Y
A T G K MY
N T G Q MY
D T G K MY
D T G K MY
D T G K MY
D T G K MY
GT E E L Y
GT E E L Y
GT E E L Y
GS DE L Y
GT DE L Y
GK DE V Y
K NDQI Y
K NDQI Y
S T RQI Y
ACKKL Y
K T NQF F
A T GRY Y
A T GRY Y
A S GK Y Y
A S GK Y Y
A S GK Y Y
A S GK Y Y
A S GK Y Y
A T GRY Y
ATAKL Y
SSDKL Y
A T GRY Y
GT S E I Y
NL GK I Y
NL GK I Y

VT
I S
KT
I S
I S
I S
R
NG
I G
RD
RE- - - T
RD
RD
KV
L N
EG

140
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
VYRDL KP
I YRDL KP
VYRDL KP
VYRDL KP
VYRDL KP
VYRDL KP
VYRDL KP
VYRDL KP
V Y R D MK P
VYRDL KP
VYRDL KP
VYRDL KP
VYRDL KP
I YRDL KL
I YRDL KL
I YRDL KL
VYRDL KL
I YRDL KL
I YRDL KL
I YRDL KL
I YRDL KL
I YRDL KL
I YRDL KL
VYRDL KL
VYRDL KL
VYRDL KL
VYRDL KL
VYRDL KL
VYRDL KL
VYRDL KL
VYRDL KL
VYRDI KL
I YRDL KL
V Y R D MK L
VYRDI KL
MH R D L K P
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
VYRDL KP
I YRDI KL
I YRDI KL
I YRDI KL
VHRDL KP
I YRDL KP
I YRDL KP
VYRDL KP
VYRDL KP
VYRDL KP
VYRDL KP
I YRDL KP
I YRDL KP
I YRDL KP
150

40
A MK I L D K Q K V
A MK I L D K Q K V
A MK I L D K Q K V
A MK C I R K K H I
A MK C I R K K H I
AL KCL KKRHI
A L K Q MK K S Q I
A L K Q MK K S Q I
A MK V L K K E I V
A MK V L Q K K V I
A MK I L D K Q K V
ACKKL EKKRI
ACKKL EKKRI
ACKKL EKKRI
ACKK L QKKRI
ACKKL NKKRL
ACKKL NKKRL
ACKKL CKKRL
A MK C L D K K R I
A MK C L D K K R I
A MK C L D K K R I
A MK C L D K K R I
AI KI L KKDVV
AI KI L KKDVV
AI KI L KKDVV
AVKI L KKDVV
AVKI L KKDVV
AVKVL KKDVI
A MK V V K K E L V
A MK V V K K E L V
A I K I I K K E MF
AI KVL KKEF I
AI KAL KKDVV
A MK I L K K E V I
A MK I L K K E V I
A MK I L K K E V I
A MK I L K K E V I
A MK I L K K E V I
A MK I L K K E V I
A MK I L K K E V I
A MK I L R K E V I
AI KI L KKEVI
A I K I I R K E MV
A MK I L R K E V I
A MK V MR K D K I
A MK V L R K A K I
A MK V L R K A K I

DNGHL Y
DA RQL Y
DA GQL Y
DT GK L Y
DT GK L Y
DT GK L Y
T T GDF F
T RCYF
T RCF F
T DAF F
A GGCL Y
ARF
P T GF
P E N WF
T GE Y F
T GQY F

A MK V
A MK V
A MK V
A MK V
A MK V
A MK V
AI KV
A MK V
A MK V
A MK V
A MK V
AL KV
AL KV
A MK A
A MK A
A MK A

ENL
ENL
ENL
ENL
ENL
ENL
ENL
ENL
ENI
ENI
ENL
ENI
ENI
ENI
ENI
ENV
ENV
ENV
ANI
ANI
ANI
ANI
DNV
DNV
DNV
DNV
DNV
DNI
DNV
DNV
DNV
DNI
DNI
ENL
ENL
ENL
ENL
ENL
ENL
ENL
ENL
ENL
ENL
ENL
ENI
ENI
ENI
ENI
ENI
ENI
ENI
ENI
ENI
ENI
ENI
DNL
ENV
ENV
ENV
ENV
ENV
ENI
ENI
ENI
ENV

L I
L I
L I
I L
I L
ML
L L
L L
L L
L L
L I
LL
LL
LL
LL
LL
LL
LL
LL
LL
LL
LL
ML
ML
ML
ML
ML
L L
L L
L L
L I
L L
L L
ML
ML
ML
ML
ML
ML
ML
ML
L L
L L
ML
L L
ML
ML
L L
L L
L L
L L
L L
L L
L L
L L
LI
LV
LV
LV
LV
LL
LI
LL
LL
LI
160

50
60
70
FPF
V K L KQI
E HT L NE K RI L QA V N
V K L KQI
E HT L NE K RI L QA V N
FPF
V K L KQV E HT L NE K RI L QA V E
FPF
V DT KQQ E HV Y S E K RI L E E L C
SPF
V DT KQQ E HV Y S E K RI L E E L C
SPF
V D T K Q E E H I F S E R H I ML S S R
SPF
V E T R Q Q Q H I MS E K E I MG E A N
CQF
V E T R Q Q Q H I MS E K E I MG E A N
CQF
V R L K Q V E H T N D E R L ML S I V T
HPF
V QK KE V A HT V GE RNI L V RT A T A DS P F
V K L KQI
E HT L NE K RI L QA V N
FPF
K K R K G E A MA L N E K Q I L E K V N S
RF
K K R K G E A MA L N E K Q I L E K V N S
RF
K K R K G E A MA L N E K Q I L E K V N S
RF
K K R K G E A MA L N E K R I L E K V Q S
RF
K K R K G Y Q G A MV E K K I L MK V H S
RF
KK K KGY QGAI V E K RI L T K V HS
RF
L F
K K K H G E K MA L L E K K I L E K V N S
K MK Q G E T L A L N E R I ML S L V S T G D C P F
K MK Q G E T L A L N E R I ML S L V S T G D C P F
K MK Q G E T L A L N E R I ML S L V S T G D C P F
K MK Q G E T L A L N E R I ML S L V S T G D C P F
I Q D D D V E C T MV E K R V L A L MD K
PPF
I Q D D D V E C T MV E K R V L A L L D K
PPF
I Q D D D V E C T MV E K R V L A L L D K
PPF
I Q D D D V E C T MI E K R V L A L Q D K
PPF
I Q D D D V E C T MV E K R V L A L P G K
PPF
L Q D D D V D C T MT E K R I L A L A R K
HPY
HDDEDI
D WV Q T E K H V F E Q A S S
NPF
HDDEDI
D WV Q T E K H V F E Q A S S
NPF
NEDEDI
D WV Q T E K S V F E A A S N
YPF
I ENDEV EST RSEKRVF L I ANKE RHPF
L M D D D V E C T M V E K R V L S L A WE
HPF
V A K DE V AHT L T E NRV L QNS R
HPF
V A K DE V AHT L T E NRV L QNS R
HPF
I AKDEV AHT L T ESRVL KNT R
HPF
I AKDEV AHT L T ESRVL KNT R
HPF
I AKDEV AHT L T ESRVL KNT R
HPF
I AKDEV AHT L T ESRVL KNT R
HPF
I AKDEV AHT L T ESRVL KNT R
HPF
I A K DE V AHT V T E S RV L QNT R
HPF
I QK DE V AHT L T E S RV L K S T N
HPF
VDRSEV AHT L T ENRVL YACV
HPF
I A K DE V AHT V T E S RV L QNT R
HPF
L E K N H A E Y MK A E R D I L T
KV DHPF
VRNAKDT AHT RAERNI L ESV
KHPF
VRNAKDT AHT RAERNI L ESV
KHPF
KVRDRV
R T K ME R D I L V E V
NHPF
S GP S
E I E DGE RHL GRS
ESPL
L KKAT L KVRDRV
R T K ME R D I L A D V
NHPF
L KKAT L KVRDRV
R T K ME R D I L V E V
NHPF
L KKASL KVRDRV
R T K ME R D I L V E V
NHPF
L K KAT I V QK AKT T E HT RT E RQV L E HI
RQS P F
L K KAT I V QK AKT T E HT RT E RQV L E HI
RQS P F
L K KAT I V QK AKT T E HT RT E RQV L E HI
RQS P F
L K K L D MI R K N D I
E RI L QE RNI L I T V R
YPF
HPF
MD K T A L A S R K K L L R A Q T E R E I L Q C L D
MD K A A L E S R K K L V R A Q T E R E I L Q S L D
HPF
MD K E S L I S R N K L V R A Q T E R E I L G L L D
HPF
VDKDAL AF RKKL RRAEVERDI L RT L D
HPF
I DRNCL T T E KKL S QV E T E A E I L S L L D
HPF
I DRDVL T AKKI
SHVET EAEI L SL L D
HPF
MD K S V ML N R N K V H R A C V E R E I I S T L D
HPF
MD K S I ML N R N K V H R A T A E R Q I L D L L D
HPF
MD K G V MR N R N K V H R A C T E R E I L D ML D
HPF
70
80
90

150
DQQGY I QV
DQQGY I QV
DHT GY I K V
DA E GY L K L
DA DGY L K L
DE RGY V K I
NE RGY GK L
NE RGY GK L
DK NGHI K I
DA NGHI A L
DQQGY I QV
DDHGHI RI
DDHGHI RI
DDHGHI RI
DDRGHI RI
DNDGNV RI
DNDGNI RI
DS QGQCRL
DE HGHV RI
DE HGHA RI
DE HGHA RI
DE HGHV RI
DS E GHI KI
DS E GHI KI
DS E GHI KI
DS E GHI KI
DS E GHI KI
DA E GHCKL
DA DGHI KL
DA DGHI KL
DA E GHI KL
T L DGHI KI
DK DGHI KI
DK DGHI KI
DK DGHI KI
DK DGHI KI
DK DGHI KI
DK DGHI KI
DK DGHI KI
DK DGHI KI
DK DGHI KI
DK DGHI KV
DRDGHI KI
DK DGHI KI
D A R G H A ML
S S QGHI K L
S S QGHI K L
DE E GHI K L
DE E GHI K I
DE E GHI K L
DE E GHI K L
DE I GHI K L
DS NGHV V L
DS NGHV V L
DS NGHV V L
A Y NGHI K L
R D D G H V ML
R E D G H I ML
R D D G H I ML
R G D G H I ML
R E D G H V ML
R E D G H I ML
QK DGHL V L
HRDGHI S L
QS NGHV S L

T DF
T DF
T DF
VDF
VDF
VDF
VDF
VDF
T DF
CDF
T DF
SDL
SDL
SDL
SDL
SDL
SDL
SDL
SDL
SDL
SDL
SDL
ADF
ADF
ADF
ADF
ADF
ADF
T DY
T DY
T DY
ADY
ADF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
ADF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
T DF
SDF
SDF
SDF
SDF
SDF
SDF
T DF
T DF
T DF
170

160
170
GF A KRV K G
GF A KRV K G
GF A KRV RG
GF A KK I GS G
GF A KK I GS G
GF A KQI GT S
GF A KK L QT G
GF A KK L QT G
GF A KY V P D
GL S KA NL T K
GF A KRV K G
GL AV HV P E G
GL AV HV P E G
GL AV HV P E G
GL AT E I P E G
GL AV E L L DG
GL AV E L K E G
GL AV E I P V G
GL ACDF S K K
GL ACDF S K K
GL ACDF S K K
GL ACDF S K K
G MC K E H MMD
G MC K E H MMD
G MC K E H MMD
G MC K E H V V E
G M C K E N I WD
G MC K E G I L N
G MC K E G L G P
G MC K E G L G P
G MC K E N I K D
G L C K E E M WY
G MC K E N ML G
GL CKE GI K D
GL CKE GI K D
GL CKE GI T D
GL CKE GI T D
GL CKE GI T D
GL CKE GI T D
GL CKE GI T D
GL CKE GI S D
GL CKE DI T Y
GL CKE E I K Y
GL CKE GI S D
GL A KE F DE
GL CKE S I HE
GL CKE S I HE
GL S KE S I DH
GL S KE AI DH
GL S KE AI DH
GL S KE S I DH
GL S KE S V DQ
GL S KE F V A D
GL S KE F V A D
GL S KE F V A D
GL S K I GL I NNT I
DL SL RCT VSL SI
DL SL RCAVSPT L
D L S L R C S V C P ML
DL SL KCDVVPKL
DL CF KSDVVPT F
DL CF KADVVPT F
DL SF L T SCNPHI
DL S CL T S CRP QV
DL S CL T S S K P QL - - 180

A
A
A
V
A
A
A
A
A

QE
EP
EP
EP
EP
EP
EP
EP
EP
EP

L VKL EFSF
L VKL EFSF
L VKL AYHF
I VKL YRT F
I VKL YRT F
I CRL YRT F
I VKL FKTF
I VKL FKTF
I I R M WG T F
I V GL K F S F
L VKL EFSF
VVSL AYAY
VVSL AYAY
VVSL AYAY
VVSL AYAY
I VSL AYAF
I VSL AYAF
I VSL AYAY
I V C MS Y A F
I V C MT Y A F
I V C MT Y A F
I V C MS Y A F
L T QL HS CF
L T QL HS CF
L T QL HS CF
L T QL QS CF
L T QL HS CF
L T QL Y CCF
L V GL HS CF
L V GL HS CF
L V GL HS CF
L L NL HACF
L T H MF C T F
L T AL KYSF
L T AL KYSF
L T SL KYSF
L T SL KYSF
L T SL KYSF
L T SL KYSF
L T SL KYSF
L T AL KYAF
L I SL KYSF
L T L L KYSF
L T AL KYAF
V V QL RY S F
I VEL AYAF
I VEL AYAF
I VKL HYAF
HCEASL SF
VVKL HYAF
I VKL HYAF
I VKL HYAF
L VT L HYAF
L VT L HYAF
L VT L HYAF
L VRF F YSF
L PT L YSHF
L PT L YSHF
L PT L YT HF
L PT L YADF
L PT L YARI
L PT L YARI
LPTL YASF
LPTL YASF
LPAL YASF
100

180
190
R T WT L C G T P E Y
R T WT L C G T P E Y
R T WT L C G T P E Y
Q
K T WT F C G T P E Y
Q
K T WT F C G T P E Y
S
K T WT F C G T P E Y
R
K T WT F C G T P E Y
R
K T WT F C G T P E Y
V T Y T L CGT P DY
N A T T NT F CGT T E Y
R T WT L C G T P E Y
Q
T I KGRV GT V GY
Q
T I KGRV GT V GY
Q
T I KGRV GT V GY
Q
RV RGRV GT V GY
Q S K T KGY A GT P GF
Q NK T KGY A GT P GF
K T T T Q K A GT GA Y
R
P HA S V GT HGY
K
P HA S V GT HGY
K
P HA S V GT HGY
K
P HA S V GT HGY
G V T T RT F CGT P DY
G V T T RT F CGT P DY
G V T T RT F CGT P DY
G V T T RT F CGT P DY
G V T T KT F CGT P DY
G V T T T T F CGT P DY
G DT T S T F CGT P NY
G DT T S T F CGT P NY
G DL T S T F CGT P NY
G S T T S T F CGT P E F
D A K T NX F CGT P DY
G A T MK T F C G T P E Y
G A T MK T F C G T P E Y
A A T MK T F C G T P E Y
A A T MK T F C G T P E Y
A A T MK T F C G T P E Y
A A T MK T F C G T P E Y
A A T MK T F C G T P E Y
G A T MK T F C G T P E Y
G RT T KT F CGT P E Y
G DK T S T F CGT P E Y
G A T MK T F C G T P E Y
N T R S N S MC G T V E Y
G A V T HT F CGT I E Y
G A V T HT F CGT I E Y
E K K A Y S F CGT V E Y
D K RA Y S F CGT I E Y
E K K A Y S F CGT V E Y
E K K A Y S F CGT V E Y
E K K A Y S F CGT V E Y
E T E RA Y S F CGT I E Y
E T E RA Y S F CGT I E Y
E T E RA Y DF CGT I E Y
E E RI RHS A V GT P DY
T G A R S MS F V G T H E Y
T S A R S MS F V G T H E Y
T D A R S MS F V G T H E Y
V A A RS KS F V GT HE Y
V T A F S RS CV GT HE Y
V T A F S KS CV GT HE Y
V T Q S NS F V GT E E Y
MR A S N S F V G T E E Y
MR A S N S F V G T E E Y
190

L AP
L AP
L AP
VAP
VAP
VAP
VAP
VAP
I AP
L AP
L AP
MA P
MA P
MA P
MA P
MA P
MA P
MA P
MA P
MA P
MA P
MA P
I AP
I AP
I AP
I AP
I AP
I AP
I AP
I AP
I AP
MA P
I AP
L AP
L AP
L AP
L AP
L AP
L AP
L AP
L AP
L AP
L AP
L AP
MA P
MA P
MA P
MA P
MA P
MA P
MA P
MA P
MA P
MA P
MA P
L AP
L AP
L AP
L AP
L AP
L AP
L AP
I AP
I AP
I AP

EI
EI
EI
EV
EV
EI
EV
EV
EV
EV
EI
EV
EV
EV
EV
EL
EL
EI
EV
EV
EV
EV
EI
EI
EI
EI
EI
EI
EI
EI
EI
EI
EI
EV
EV
EV
EV
EV
EV
EV
EV
EV
EV
EV
EI
EI
EI
EV
EV
EV
EV
EV
DI
DI
DI
EI
EI
EI
EI
EV
EL
EL
EV
EI
EI

80
KDNSNL
KDNSNL
KDNSNL
KDNKYV
KDNKYV
RDEKYV
KDKKYL
KDKKYL
QDA QQI
QT P T DL
KDNSNL
ET KDAL
ET KDAL
ET KDAL
ET KDAL
ET KADL
ET KT DL
DT KT HL
HT PDKL
HT PDKL
HT PDKL
HT PDKL
QT V DRL
QT V DRL
QT V DRL
QT V DRL
Q T MD R L
QT K DRL
QT T S RL
QT T S RL
QT E S RL
QT E T RV
QT K E NL
QT HDRL
QT HDRL
QT K DRL
QT K DRL
QT K DRL
QT K DRL
QT K DRL
QT HDRL
QT NDRL
QA QY HI
QT HDRL
QT K Y RL
QT GGKL
QT GGKL
QT E GKL
QT E GKL
QT E GKL
QT E GKL
QT E GKL
QT E T KL
QT E T KL
QT E T KL
T CRDNL
ETEKFS
ET DKF S
ET DKF Y
EASHYA
DESHYT
DASHYT
QT S T HV
QT K T HI
QT K T HV

I
I
I
I
I
I
I
I
V
L
I
V
V
V
V
L
L
L
L
L
L
L
I
I
I
I
I
L
L
L
L
L
L
L
L
L
L
L
L
L
L
L
I
L
V
L
L
V
V
V
V
V
V
V
V
L
I
I
I
I
V
V
I
I
I

90
100
Y MV ME Y V A G G E MF S H L R R I G
Y MV ME Y V P G G E MF S H L R R I G
Y MV L E Y V L G G E MF S H L R K S G
Y M L L E A C L G G E L WS I L R D R G
Y M L L E A C L G G E L WS I L R D R G
Y M L L E A C M G G E I WT M L R D R G
Y M L M E S C L G G E L WT I L R D K G
Y M L M E S C L G G E L WT I L R D K G
F MI MD Y I E G G E L F S L L R K S Q
Y L V T D Y M S G G E L F WH L Q K E G
Y MV ME Y V P G G E MF S H L R R I G
C L V L T L MN G G D L K F H I Y H MG Q A
C L V L T L MN G G D L K F H I Y H MG Q A
C L V L T L MN G G D L K F H I Y H MG Q A
C L V L T I MN G G D L K F H I Y N L G N P
C L V MT I MN G G D I R Y H I Y N V N E E
C L V MT I MN G G D V R Y H I Y N V D E D
C L V MS L MN G G D L K Y H I Y N I G E K
S F I L D L MN G G D L H Y H L S Q H G
C F I L D L MN G G D L H Y H L S Q H G
C F I L D L MN G G D L H Y H L S Q H G
S F I L D L MN G G D L H Y H L S Q H G
Y F V ME Y V N G G D L MY H I Q Q V G
Y F V ME Y V N G G D L MY H I Q Q V G
Y F V ME Y V N G G D L MY H I Q Q V G
Y F V ME Y V S G G D L MY H I Q Q V G
Y F V ME Y V N G G D L MY H I Q Q V G
F F V ME Y V N G G D L MF Q I Q R S R
F L V I E Y V N G G D L MF H MQ R Q R
F L V I E Y V N G G D L MF H MQ R Q R
F F V I E F V P G G D L MF H MQ Q Q R
Y F V ME Y I S G G D L ML H I Q R G
F F V ME Y L N G G D L MY H I Q S C H
C F V ME Y A N G G E L F F H L S R E R
C F V ME Y A N G G E L F F H L S R E R
C F V ME Y V N G G E L F F H L S R E R
C F V ME Y V N G G E L F F H L S R E R
C F V ME Y V N G G E L F F H L S R E R
C F V ME Y V N G G E L F F H L S R E R
C F V ME Y V N G G E L F F H L S R E R
C F V ME Y A N G G E L F F H L S R E R
C F V M Q Y V N G G E L F WH L S H E R
C F V ME F A N G G E L F T H L Q R C K
C F V ME Y A N G G E L F F H L S R E R
Y L V L DF V NGGHL F F QL Y QQG
Y L I L E CL S GGE L F T HL E RE G
Y L I L E CL S GGE L F T HL E RE G
Y L I L DF L RGGDL F T RL S K E V
Y L I L DF L RGGDL F T RL S K E V
Y L I L DF L RGGDL F T RL S K E V
Y L I L DF L RGGDL F T RL S K E V
Y L I L DF L RGGDV F T RL S K E V
HL I L DY I NGGE L F T HL S QRE
HL I L DY I NGGE L F T HL S QRE
HL I L DY I NGGE L F T HL S QRE
Y L V ME Y L N G G D L Y S L L Q K V G
C L V ME F C P G G D L H T L R Q R Q P G K
C L V ME F C P G G D L H A L R Q K Q P G K
C L V ME Y C S G G N L H S L R Q R Q L N K
C L V ME F C P G G D L H V A R Q R Q P G R
CL L I DY A P NGDL HS L L RK QP GN
CL L I DY CP NGDL HS L L RK QP NN
CL I T DF CP GGE L F A L L DK QP L K
CL I T DY CP GGE L F V L L DNQP L K
CL I T DY Y P GGE L F L L L DQQP T K
110
120

200
L S
K GY NK A V
L S
K
L S
K GY NK A V
L N
K GHDF S V
L N
K GHDF S V
L N
K GHDRA V
L N
RGHDI S A
L N
RGHDI S A
ST
KPYNKSI
L D E A G Y T K MV
L S
K GY NK A V
RN
ERYT F SP
RN
ERYT F SP
RN
ERYT F SP
NN
EKYTFSP
QG
EEYDF SV
RG
EEYDF SV
TE
T PYRT SV
QK G V A Y DS S A
QK G T A Y DS S A
QK G T A Y DS S A
QK G V A Y DS S A
AY
QP Y GK S V
AY
QP Y GK S V
AY
QP Y GK S V
AY
QP Y GRS V
AY
QP Y GK S V
QE
L E Y GP S V
RG
E E Y GF S V
RG
E E Y GF S V
RG
DE Y GF S V
MD
K RY GRA V
L G
QK Y NHS V
ED
NDY GRA V
ED
NDY GRA V
ED
NDY GRA V
ED
NDY GRA V
ED
NDY GRA V
ED
NDY GRA V
ED
NDY GRA V
ED
NDY GRA V
DD
NDY GQA V
ED
I DYDRSV
ED
NDY GRA V
QG RG HDK A A
VR
S GHNRA V
VR
S GHNRA V
NR
RGHT QS A
NR
RGHT QS A
NR
QGHT HS A
NR
RGHT QS A
NR
RGHS QS A
RGGDS GHDK A V
RGGDS GHDK A V
RGGDS GHDK A V
L G
T E HGY A A
KG
E GHGS A V
KG
E GHGS A V
RG
E GHGS A V
SG
QGHGS A V
SG
NGHGS GV
AG
NGHGS GV
TG
ASHT SAI
TG
A GHT S A V
TG
S GHT S A V

210
220
D WWA L G V L I Y E M A A G Y
V GA
D WWA L G V L V Y E M A A G Y
D F WS L G I L V Y E L L T G N
D F WS L G I L V Y E L L T G N
D Y WA L G I
D Y WS L G V L M F E L L T G T
D Y WS L G V L M F E L L T G T
D WWS F G I L I Y E M L A G Y
D F WS L G V L V F E M C C G W
D WWA L G V L I Y E M A A G Y
D WWA L G C L L Y E M I A G Q
D WWA L G C L L Y E M I A G Q
D WWA L G C L L Y E M I A G Q
D WWG L G C L I Y E M I Q G H
D Y F A L G V T L Y E MI A A R
D Y F A L G V T L Y E MI A A R
D WWA L G C S I Y E M V A G Y
D WF S L G C M L F K L L R G H
D WF S L G C M L F K L L R G H
D WF S L G C M L F K L L R G H
D WF S L G C M L F K L L R G H
D WWA Y G V L L Y E M L A G Q
D WWA Y G V L L Y E M L A G Q
D WWA Y G V L L Y E M L A G Q
D WWA I G V L L Y E M L A G Q
D WWA F G V L L Y E M L A G Q
D WWA L G V L M Y E M M A G Q
D WWA L G V L M F E M M A G R
D WWA L G V L M F E M M A G R
D WWA L G V L M F E M M A G R
D WWA F G V L I Y Q M L L Q Q
D WWS F G V L L Y E M L I G Q
D WWG L G V V M Y E M M C G R
D WWG L G V V M Y E M M C G R
D WWG L G V V M Y E M M C G R
D WWG L G V V M Y E M M C G R
D WWG L G V V M Y E M M C G R
D WWG L G V V M Y E M M C G R
D WWG L G V V M Y E M M C G R
D WWG L G V V M Y E M M C G R
D WWG T G V V M Y E M I C G R
D WWG V G V V M Y E M M C G R
D WWG L G V V M Y E M M C G R
D WWS V G I L L F E M L T G K
D WWS L G A L M Y D M L T G S
D WWS L G A L M Y D M L T G S
D WWS F G V L M F E M L T G T
D WWS F G V L M F E M L T G S
D WWS Y G V L M F E M L T G S
D WWS F G V L M F E M L T G T
D WWS Y G V L M F E M L T G T
D WWS L G V L M Y E L L T G A
D WWS L G V L M Y E L L T G A
D WWS L G V L M Y E L L T G A
D WWS A G I V L F E L L T G I
D WWT F G I F L Y E L L F G K
D WWT F G I F L Y E L L F G Q
D WWT F G V F L Y E L L H G M
D WWT L G V F M Y E M L Y G R
D WWA F G I F L Y E L L Y G T
D WWA F G I F L Y E M L Y G T
D WWA L G V L L Y E M L Y G R
D WWA L G I L L Y E M L Y G Y
D WWA L G I L L Y E M L Y G Y
200
210

Figure 1 alignment showing the common fold specific signals, along with the group specific sub-family function specific signals
A multiple
A multiple alignment showing the common fold specific signals, along with the group specific sub-family function specific signals. Alscript [36] figure showing a portion of the alignment of representatives of six protein kinase families
discussed in the text. The alignment is coloured based on residue conservation: Red and pink – identical and conserved across
all families – correspond to fold signals, and blue and green – identical and conserved within a family. Positions predicted to
confer specificity for the family [35] are highlighted in yellow. Deleted regions are indicated by dashes (- - -). Numbers below
the alignment correspond to the PDB structure 2f7z.

Page 3 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

text as HMM-t). In addition, improved specificity is
imparted by using negative training sequences to modify
model parameters – the emission and transition probabilities – to make the model more specific (referred henceforth as HMM-ModE). The method is applied in a highthroughput classification exercise to finely classify a sample derived from an earlier fold level data mining of protein kinases [23]. The sub-family profile HMM with
default threshold will be referred to as HMM-d to differentiate from the profile HMM used with the optimal discriminating threshold, HMM-t.

Results and Discussion
Improved specificity is obtained by optimising the
discrimination threshold
The HMM built from positive training sequences contains
sub-family specific signals in addition to the common signals that arise from the family fold. The log-odds score, a
measure of how much more probable the sequence is to
be emitted by the given HMM than by the random null
model, is routinely used in sequence profile comparison.

S = log

P( X1... Xn | M)
P( X1... Xn | Null)

where P(X1,...Xn | M) is the probability of the sequence
X1...Xn being emitted by the model M, and P(X1,...Xn |
Null) is the probability of the sequence being emitted by
the null model.
All the sequences which obtain a positive score are considered to belong to family for which the model is built. The
significance of this score, in HMMER, is calculated as an
"E-value", assuming an extreme-value distribution whose
parameters are either calculated during calibration, or
from a conserved upper bound [24]. The use of the Evalue is empirical, as the exact nature of the distribution
of scores from global alignments is still unknown [24],
though it has been shown that HMM score distributions
are not an extreme-value distribution[25]. The Pfam database uses curated thresholds as an additional aid to the Evalue: a "trusted" cutoff (TC1) – which is the lowest score
of a true positive in the full alignment, a "noise" cut-off
(NC1) which is the highest score for a sequence not
included in the dataset, and a "gathering" threshold
(GA1), which is the threshold that is actually set to collect
the sequences in the Pfam Full alignment where
TC1>GA1>NC1 [11]. These criteria cannot be uniformly
applied to pre-classified positive and negative sequence
data, as there maybe negative sequences with higher
scores than positive sequences.
For a given threshold score, a sequence from the positive
set will be classified as a true positive(TP) or false negative(FN), and one from the negative set as a true nega-

http://www.biomedcentral.com/1471-2105/8/104

tive(TN) or false positive(FP). Using these terms,
sensitivity (TP/(TP+FN)) and specificity (TP/(TP+FP))
maybe used to measure the performance of a classifier.
Receiver-Operator Characteristic curves (1-specificity v/s
sensitivity) [22] show that the discriminating potential of
the default HMM profile is inherently high and that the
poor specificity of the HMM, generated from positive
training sequences, results from the default threshold
based on null probabilities (Figure 2). We use the Mathews correlation coefficient to indicate the optimal threshold. Normally used methods for testing the efficacy of
discrimination in machine learning methods include
cross-validation, where the sample is split into training
and test data, and bootstrapping, where the data is randomly sampled multiple times [21]. N-fold cross-validation or jackknifing ranges from "sample-splitting" –
where the sample is split equally into a test and training
set, to "leave-one-out" – where the method is tested iteratively through the sample set, using as the test set a single
sequence, and the remainder of the sample as a training
set. In order to allow the method to be used in highthroughput analysis, we use 10-fold cross-validation,
which lies between the accuracy of bootstrapping, and the
speed of sample-splitting. We use the mode of the average
MCC distribution as the optimal discrimination threshold. (Figure 3A).
Further improvement in discrimination is provided by using
negative sequences to train the HMM
Increased discrimination is provided by modifying emission and transition probabilities in the model by incorporating probabilities derived from negative training
sequences directly into the model. Earlier work that used
HMM with discriminative training modified model emission probabilities by iteratively aligning negative
sequences to the model [15]. This method uses the capabilities of the HMM to both generate the multiple alignment and train the model with positive and negative
sequences, a feature which is not available with HMMER,
which uses a null model containing position independent
probabilities derived from background frequencies of the
amino acids. Moreover, multiple alignments generated
from HMMs are not as accurate as methods employing
scoring matrices – the profiles from Pfam are often handedited, and our use of hmmalign [24] to align negative
training data does not generate alignments of the quality
as specialized multiple alignment programs working from
sequences (data not shown). The advent of fast and accurate multiple alignment programs such as MUSCLE [26]
permits the generation of the model parameters by using
profile-profile alignments of the positive and negative
samples. Analysis of these profiles allows the easy identification of alignment positions capable of increased discrimination, and the modification of model parameters to
implement them. Discriminating alignment positions can

Page 4 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

Figure 2
and HMM-ModE for the PVPK sub-family
A Receiver-Operator Characteristic curve (ROC) of HMM-d
A Receiver-Operator Characteristic curve (ROC) of
HMM-d and HMM-ModE for the PVPK sub-family.
HMM-ModE – blue; HMM-d – red;

work well on classifying sequences at the sub-family level
that have been previously classified to the family level, it
is insufficient to accurately mine a large database. The use
of Z-scores to select variables (alignment positions)
involved in maximal discrimination loses information
that is shared between the positive and negative
sequences, increasing the likelihood of an unrelated
sequence that may contain the reduced pattern by chance.
This is particularly likely in cases where specificity is conferred by only a few residues, or even a single position
[29]. We propose a mixed score – that would discriminate
the sequence belonging to the subfamily against a
sequence containing the pattern by chance by incorporating the fold components of the profile, and against
sequences from other subfamilies, by incorporating information related to the specificity determining residues
identified using relative entropy.
REiNeg =
REiNull =

be identified using relative entropy(REi) between the
probability distributions of the positive (p) and negative
(q) sets for a position i [27,28].

REi = ∑ pi ,x log

pi ,x
qi ,x

where pi,x and qi,x are the probabilities of the amino acid x
at a position i in the positive and negative sets respectively.
In order to use a model independent method of selecting
discriminating alignment positions, Z-scores based on the
distribution of cumulative relative entropies (CREi) for
the alignment may be used.

CREi =
Zi =

∑

x =1...20

pi ,x log

pi ,x
qi ,x

+

∑

x =1...20

qi ,x log

qi ,x
pi ,x

CREi − μ
σ

where μ and σ are the mean and standard deviation of the
CRE distribution.
The log-odds score is then given by

S=

p

∑ log qi,x

z >0

i ,x

High Z-scores (Z > 3) are associated with specificity determining positions [17], but although this method may

∑

pi ,x log

∑

pi log

x =1...20

x =1...20

pi ,x
qi ,x
pi ,x

PxNull

pi ,x
⎧
,
REiNeg > REiNull ∧ qi ,x > pxNull
⎪ ∑ log
qi ,x
⎪ x =1...20
S= ∑ ⎨
p
i =1...n ⎪
log i ,x , otherwise
⎪ ∑
PxNull
⎩ x =1...20
where PxNullis the null probability of amino acid x. Other
terms are as defined earlier.

This effectively calls for a position dependent null model,
that incorporates information from the negative training
sequences. Though the Viterbi algorithm uses a log score
in aligning a sequence to a profile to prevent underflow
errors, this score is calculated from the model emission
probabilities. In order to preserve the plan7 architecture
used in HMMER, we use a heuristic method that modifies
the model emission probabilities to implement this
mixed model score.
The mixed model above still does not capture all information available from the false positive sequences. Consider
the case where there is an conserved insert in the negative
sequences that is absent in the positive sequences. As there
is no equivalent emission probabilities in the positive
profile (the matching columns in the positive profile
HMM would be delete states), this information is lost. A
trivial implementation of the log-odds score with known
positive and negative sequences maybe made by scoring
the sequence against the profiles generated from both
positive sequences and negative sequences, and subtracting the negative profile score from the score of the
sequence against the positive profile.

Page 5 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

A

B

C

Figure 3
Determination of optimal discrimination threshold
Determination of optimal discrimination threshold. The average MCC(bold black) distribution is overlayed on the sensitivity and specificity plots for each of 10-fold cross validation samples of the PVPK sub-family. Figures are plotted for the
default profile HMM-d (top, A), HMM-ModE (center, B) and HMM-Sub(bottom, C).

Page 6 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

S = log

P( X1... Xn | MPos )
P( X1... Xn | MNeg )

⎛ P( X1... Xn | MPos ) P( X1... Xn | Null) ⎞
⎟
×
= log ⎜
⎜ P( X1... Xn | Null) P( X1... Xn | MNeg ) ⎟
⎝
⎠
P( X1... Xn | MNeg )
P( X1... Xn | MPos )
= log
− log
P( X1... Xn | Null)
P( X1... Xn | Null)
This log-difference-of-odds-scores (henceforth referred to
as HMM-Sub) would provide the maximum discrimination between the positive and negative datasets, but has
some caveats discussed below. The comparative impact of
these methods is shown in Figure 3 for a randomly
selected dataset. It is apparent that the MCC distribution
is successively broader and has a higher maximum with
each method, corresponding to increased discrimination
between the positive and negative datasets.
Validation
Emission probabilities were modified as described in
methods. Existing methods for modifying transition probabilities [16] from negative training data sampling [30] to
improve the efficiency of HMMER were used without
change. As negative training data is significantly larger in
size than positive training data, the speed of implementation of HMM-ModE is improved by only selecting false
positives from the negative training data, thus limiting its
size to those sequences that significantly influence discrimination. The use of profile-profile alignments also
permits easy calculation of resultant models, as the match
states of columns of the positive and negative training
data are aligned.

Protein Kinases provide the kind of challenge sub-family
classification demands. Protein Kinases were first classified by Hanks[31] into distinct families that share basic
structural and functional properties based on similarity in
catalytic domain amino acid sequence, and more recently
have been classified into 12 fold groups based on structural fold similarity. Each of the fold groups is further classified into families which can be distinguished from one
another by representative HMMs [23]. Within the family,
finer functional classification is often not possible due to
the large proportion of shared fold signals. One such
instance is the AGC family of Serine/Threonine Protein
Kinases (Figure 4). The AGC family contains Protein
Kinases such as cAMP-dependent Protein Kinase (PKA),
Protein Kinase C, Protein Kinases related to PKA and PKC
(RAC), G protein-coupled receptor kinase (GRK), ribosomal S6 PK, and the PVPK1 Protein Kinase homologs in
plants [31]. The proteins all share a two-lobed structure
and high level of sequence similarity, yet have different
substrate specificity [32]. The results of the application of

http://www.biomedcentral.com/1471-2105/8/104

the above methods on this dataset is reported in Table 1.
GRK has an insert relative to the other sequences, which is
sufficient for HMMER with a suitable cut-off to improve
its specificity. In all the other sub-families, the distribution of scores for positive and negative sequences overlap
allowing an assessment of the discrimination capabilities
of the methods described in this paper. In general, there is
an increase in specificity using the HMM-ModE protocol,
albeit with a reduction in sensitivity from the hmmer
score with a default threshold. In the case of S6PK, the
reduced sensitivity is due to three sequences in the dataset
being shorter than the rest. As the log-odds-score increases
with sequence length, this is an expected development,
and must be used as a caveat for the general application of
the method.
G-Protein coupled receptors, which play a key role in cellsignaling network that control an array of physiological
processes [33] have also been classified into sub-families
on the basis of their substrate specificity[20]. These proteins are characterised by the conservation of seven transmembrane regions, the selection criteria being
hydrophobic residues. Sequences from one sub-family
often have higher sequence similarity with members of
other families than within the sub-family. This dataset has
also been the focus of the application of the SVM as a discriminator[19], and hence is interesting as it provides a
comparison to the methods detailed above. Karchin et al
have compared the relative performances of SVM, BLAST
and HMMs for the classification of GPCR sub-families
that bind to a specific ligand, defined by them as "level-2"
sub-families (Figure 5 and 6). They calculate coverage
(which is the percentage of True Positives selected before
the first False Positive error) and the errors per sequence at
the Minimal Error Point (MEP) as the parameters for evaluating the different methods, each of which could work
best at different score thresholds. The former is indicative
of the sensitivity of a discriminating method whereas the
latter, since it is a total of both the False Positive as well as
False Negative errors, indicates both sensitivity and specificity. These statistics are calculated by sweeping a threshold over the E-values combined from all the sub-families.
The coverage values reported for SVM, BLAST and HMM
are 65%, 13.3% and 5% respectively. Our HMM-d has a
coverage of 13% which is comparable to the values
reported for BLAST and HMM. The coverage of HMMModE (27%) is better than that of HMM-d. On the other
hand, the 18% error at the MEP obtained for HMM-ModE
is comparable to the 13.7% reported for SVM but lower
than those reported for BLAST and HMM (25.5% and
30% respectively) or 21% obtained for HMM-d. However,
we note that the average coverage and errors at MEP are
calculated after combining and normalising results of different sub-families using the E-values. The results for
HMM-ModE should be better than those observed using

Page 7 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

these parameters as sequence classification is based on the
threshold score and not the E-value. A better comparison
to the SVM results above, which also uses a discriminant
score and not a significance value, would be to average
sub-family values of these parameters. HMM-ModE then
returns values of 96% coverage, and 6% error rate at MEP
(Table 2).
The relatively poor results for Octopamine is due to the
fact that there are only twelve sequences in the dataset,
and they have higher sequence similarity with the serotonin sub-class than with each other (Table 2). Since our
choice of threshold is optimised for specificity, there is a
sharp fall in sensitivity. The HMM-ModE profile provides
an improvement in the coverage values for 11 of the subfamilies. Only in one case (OlfactoryII family6) is the coverage for HMM-ModE worse than HMM-d.
Classification of kinases
To test the above protocol in a high-throughput annotation case study, we applied the method to classify protein
kinase sequences at a functional level. Protein Kinase
sequences have been classified by Cheek et al [23] into
fold groups on the basis of structural similarity and further into families of homologous sequences. Each family
is made up of sub-families denoted by EC numbers. We
constructed function-specific sub-family profiles using
sequences from the ENZYME [34] database as a training
set. The protein S/T – Y/atypical kinase/lipid kinase/ATPgrasp fold group contains enzymatic functions belonging

http://www.biomedcentral.com/1471-2105/8/104

to 36 different EC numbers, of which 19 EC numbers have
3 or more sequences available (Figure 7). We could populate the training set by mining databases for annotated
sequences that fitted the description of the class, but used
only specified sequences in this validation. Two generic
activities, namely "protein kinase" and "protein tyrosine
kinase" (EC numbers 2.7.1.37 and 2.7.1.112 respectively)
were not included in the analysis.
The application of the method in high-throughput analysis is instructive. A careful perusal of the sequences classified showed that very few sequences with annotations
outside of the sub-family were scored using HMM-ModE
and HMM-t, commensurate with their expectation of high
sensitivity and specificity. Rhodopsin and Beta-adrenergic
receptor kinases are sub-families belonging to the G-protein-coupled receptor kinase 1 family which bind different substrates. The HMM-d profile for the Rhodopsin
kinase sub-family (EC number 2.7.1.125) selected 18
sequences annotated as beta-adrenergic receptors from a
database of 56,144 protein kinase sequences previously
classified by Cheek et al [23]. The HMM-sub and HMM-d
protocols each also classified 14 v-akt murine thymoma
viral oncogene homologs as belonging to the rhodopsin
kinase sub-family. HMM-ModE and HMM-t did not pick
these false positives. Similarly, the HMM-d profile for the
beta-adrenergic receptor kinase family (EC number
2.7.1.126) selected 5 rhodopsin kinase sequences whereas
HMM-ModE, HMM-t and HMM-sub misclassified 3 rhodopsin kinases. Sequences mined with Pfam profiles as

G protein-coupled receptor kinase (GRK)
Cyclic nucleotide regulated protein kinase (PKA)
AGC Kinases

Protein kinase C (PKC)
Flowering plant PVPK1 protein kinase (PVPK)
RAC/Akt protein kinase, related to PKA and PKC (RAC)
Ribosomal protein S6 kinase (S6PK)

Figure 4
Six subfamilies of the AGC family of protein kinases
Six subfamilies of the AGC family of protein kinases

Page 8 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

Table 1: Performance of HMM-d, HMM-t, HMM-ModE and HMM-Sub for the sub-family classification of the AGC family of kinases.
Methods
Sub-groups of AGC kinases
GRK
PKA
PKC
PVPK
RAC
S6PK

HMM-d
Sensitivity
Specificity

HMM-T
Sensitivity
Specificity

1
0.96
0.99
1
1
1

1
0.89
0.95
0.94
0.9
0.98

(0)
(0.1)
(0.05)
(0)
(0)
(0)

0.27
0.18
0.42
0.17
0.09
0.14

(0.03)
(0.02)
(0.1)
(0.03)
(0.00)
(0.01)

(0)
(0.13)
(0.08)
(0.1)
(0.16)
(0.08)

1
1
0.99
0.93
1
0.98

(0)
(0)
(0.2)
(0.13)
(0)
(0.06)

HMM-ModE
Sensitivity
Specificity
1
0.89
0.96
0.94
0.93
0.975

(0)
(0.13)
(0.08)
(0.1)
(0.1)
(0.08)

1
1
1
0.96
1
0.98

(0)
(0)
(0)
(0.12)
(0)
(0.06)

HMM-Sub
Sensitivity
Specificity
1
0.96
0.97
0.96
0.97
0.93

(0)
(0.07)
(0.06)
(0.08)
(0.1)
(0.24)

1
1
1
1
1
0.98

(0)
(0)
(0)
(0)
(0)
(0.06)

The values in parentheses indicate the standard deviation for all 10 samples in a 10-fold cross validation.
HMM-d – HMM profile used with default threshold
HMM-t – HMM profile used with optimised threshold
HMM-ModE – profile with modified emission probabilities
HMM-Sub – Log-difference-of-odds-score method

applied in Cheek et al [23] may not be specific at the functional level. For example, Pfam profile PF01633 is
described as choline/ethanolamine kinase whereas
choline kinase and ethanolamine kinase have different EC
numbers signifying different substrate specificities
(2.7.1.32 and 2.7.1.82 respectively). HMM-d, and HMMt classisfied 45 and 31 sequences as ethanolamine kinases
respectively. However, inspection of the classified
sequences showed that 13 sequences annotated as choline
kinases were also picked up by HMM-d but HMM-t only
misclassified 3 choline kinase sequences. A similar trend
was observed for the activities of phosphorylase kinase
(EC number 2.7.1.38) and Calcium/Calmodulin dependent protein kinase (EC number 2.7.1.123). HMM-d,
HMM-t, HMM-ModE and HMM-Sub misclassified 12, 1,
7 and 7 phosphorylase kinase sequences respectively as
belonging to the Calcium/Calmodulin dependent protein
kinase sub-family. It must be noted that in this case the
number of correctly classified sequences for HMM-ModE
was more than that of HMM-t(155 compared to 147). The
HMM-d profile for phosphorylase kinase also selected
176 Calcium/Calmodulin dependent protein kinase
sequences whereas the other methods did not pick up any
sequence labeled as Calcium-Calmodulin Kinase.
The relatively high specificity of the HMM-ModE profiles
and HMM-t provides a greater confidence with which to
annotate unknown, hypothetical, putative or unnamed
sequences. Table 3 shows the number of such sequences
which have been annotated by our protocol.
HMM-sub provides inconsistent results when used
directly on a database of generic sequences. For protein
families where the division of proteins into functional
sub-types can be accomplished by phylogeny, this
method would work well, as the specificity determining
columns would then contain mutually exclusive amino
acids in the different sub-families, and maximum discrimination would be provided by the application of this
method. However at the level of classification we target

the application of these methods, proteins usually have
multiple features, not necessarily dependent on its molecular function that co-evolve. Examples include variations
in sub-cellular location – membrane-bound or cytosolic,
differing affinities for more than one substrate, or the
interaction with other proteins that differ across paralogs.
In addition, by effectively removing all features shared
with the family, the method has a high chance of picking
up false positives which may contain features unrelated to
the molecular function.
Protein families whose members have convergently
evolved is a case which will result in the failure of the
methods described here. Though the catalytic activity of
these proteins is the same, and the amino acids that confer
this specificity would be similarly conserved in space,
their arrangement in the sequence would be dependent
on the scaffold of the protein fold. Although this case is
not present in any of the case studies presented in this
paper, we guard against this eventuality by first doing a
phylogenetic clustering of the sequences from the subfamily. In the case of multiple folds, separate fold-based
profiles maybe used. The clustering is also helpful in the
case of very large training datasets, to allow sampling representative of the complete dataset to generate the multiple alignment.

Conclusion
We have implemented a protocol to classify protein
sequences based on profile HMMs. This protocol maximises the discrimination of the sequence belonging to the
subfamily against a sequence containing the pattern by
chance by incorporating the fold components of the profile, and against sequences from other subfamilies, by
incorporating information related to the specificity determining residues identified using relative entropy.
Although essentially implementing ideas suggested by
Mamitsuka[15], Hannehalli and Russell[17], Wistrand
and Sonnhammer[16], and Brown et al [13], this protocol
is faster in training, as only negative sequences that are

Page 9 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

Class A

Acetylcholine muscarinic

Amine

Adrenoceptors

Dopamine

Histamine

Serotonin

Octopamine

Traceamine

Angiotensin

Bombesin

Bradykinin

C5aanaphylatoxin

APJlike

Fmet leu phe

Interleukin 8

Chemokine

CCK

Peptide

Endothelin

Melanocortin

NeuropeptideY

Neurotensin

Opioid

Somatostatin

Tachykinin

Vasopressin like

Galaninlike

Proteinase activatedlike

Orexin neuropeptideFF

UrotensinII

Adrenomedullin G10D

GPR37 endothelinB like

Chemokinereceptor like

NeuromedinUlike

AllatostatinC drostatinC

Somatostatin andangiogenin likepeptide

Hormoneprotein

Folliclestimulatinghormone

GonadotropintypeI

Thyrotropin

GonadotropintypeII

Lutropin choriogonadotropichormone

Rhodopsin

RhodopsinVertebrate

RhodopsinArthropod

RhodopsinMollusc

RhodopsinOther

OlfactoryIIfam1

OlfactoryIIfam2

OlfactoryIIfam4

OlfactoryIIfam5

OlfactoryIIfam6

OlfactoryIIfam7

OlfactoryIIfam8

OlfactoryIIfam10

OlfactoryIIfam11

Olfactory

OlfactoryIIfam12

OlfactoryIfam51 52

OlfactoryFOR like fish

OlfactoryIIfam3

OlfactoryXOR like frog

OlfactoryunclassifiedclassII

Prostanoid

Prostaglandin

Prostacyclin

Nucleotide like

Adenosine

Purinoceptors

Gonadotropin
releasinghormone

Gonadotropin releasinghormone Mammals

Thyrotropin
releasinghormone
Secretagogue

Thromboxane

Gonadotropin releasinghormone others
Thyrotropin releasinghormone
Growthhormonesecretagogue
Growthhormonesecretagoguelike
PlateletADP KI01receptors SREB
Masproto oncogene

ClassAOrphan other

RDC1

ORPH

LGRlike hormonereceptors

GPR

Cannabinoid
Plateletactivatingfactor
Melatonin
Viral
Lysosphingolipid LPA EDG
LeukotrieneB4receptor
Level 1 Subfamilies

GPR45like

Cysteinylleukotriene

Mas relatedreceptors MRGs

GP40like

Level 2 Subfamilies

Figure 5
An outline of some Level 1 and Level 2 subfamilies of the GPCR Class A proteins
An outline of some Level 1 and Level 2 subfamilies of the GPCR Class A proteins. The level-2 sub-families used in
this study are marked in bold.

Page 10 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

Class C

MetabotropicglutamategroupI
MetabotropicglutamategroupII
MetabotropicglutamategroupIII
Metabotropicglutamateother

Metabotropicglutamate

Extracellularcalcium sensing
Pheromone

Calcium sensinglike
Putativepheromonereceptors

GABA Bsubtype1
GABA Bsubtype2
GABA Blike

GABA B
OrphanGPRC5
OrphanGPCR6
Brideofsevenlessproteins BOSS
Tastereceptors T1R
Level 1 Subfamilies

Level 2 Subfamilies

Figure 6
An outline of some Level 1 and Level 2 subfamilies of the GPCR Class C proteins
An outline of some Level 1 and Level 2 subfamilies of the GPCR Class C proteins. The level-2 sub-families used in
this study are marked in bold.

selected by the sub-family HMM as false positives, are
used in modifying model parameters, and optimising the
discrimination threshold. The use of HMMER for searching and scoring sequence databases remains unchanged
except for our use of recent modifications to the model
that aid improved discrimination. The hmmsearch Evalue is no longer applicable as some of the model probabilities are modified to reflect information from negative
training sequences, though the null probability used by
the program to calculate the E-value still remains that of
the original model as it is common across all states in the
model.
The availability of accurately pre-classified protein
sequences is an important starting point for classification
based on function. Datasets classified on the basis of
folds, such as the kinase set used in this work, additionally
provide an opportunity for finer classification based on
more specific function. Increased use of methods such as
described in this manuscript, with a high prediction accuracy, will provide confidence in functional annotation of
protein sequences which are generated from highthroughput genome sequence projects, a large proportion
of which are of not experimentally characterised.
Given the above results, we recommend that if the coverage is 1 (i.e the highest false positive score is less than the
lowest true positive score) the threshold as specified in

Pfam may be used. If the coverage is less, then the threshold calculated using 10-fold cross-validation as described
in this paper, is the optimal discriminating threshold for
the given dataset, and can be used in place of the "gathering" threshold for sub-family classification. Further discrimination is possible if there are sufficient false positive
sequences to build a profile.

Methods
Datasets used in the study
The sequences belonging to the 6 sub-families of the AGC
protein kinase family, each with different ligand specificities, were kindly provided by the authors of [35]. These
sequences included 66 sequences of cyclic nucleotide regulated Protein Kinases (PKA), 135 sequences of Diacylglycerol-activated/phospholipid-dependent protein kinase
C (PKC), 23 sequences of RAC/Akt protein kinases,
related to PKA and PKC, (RAC), 58 sequences of G protein-coupled receptor kinases (GRK), 40 sequences of protein kinases that phosphorylate the ribosomal protein S6
family (S6PK) and 48 sequences of the flowering plant
protein kinase homolog family (PVPK1) (Figure 4).

Protein sequences belonging to level-2 sub-families of the
Class A (Figure 5) and Class C GPCR (Figure 6) proteins
were kindly provided by the authors of [19]. The
sequences are a part of two mutually exclusive sets called
set0 and set1 which are used in a two-fold cross validation

Page 11 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

Table 2: Coverage (percentage of True Positives identified before the first False Positive) and the average percentage of errors per
sequence at the MEP of HMM-d and HMM-ModE for classification of Level-2 sub-families of Class A and Class C GPCR proteins

Coverage
HMM-ModE

Average errors per sequence at MEP

HMM-d

HMM-ModE

HMM-d

Set0

Set1

Set0

Set1

Set0

Set1

Set0

Set1

Acetylcholine_muscarinic

1

1

1

0.92

0

0

0

0.08

Adenosine

1

1

1

1

0

0

0

0

0.48

0.97

0.45

0.97

0.06

0.03

0.06

0.03

Adrenomedullin_G10D

1

1

1

1

0

0

0

0

Angiotensin

1

1

1

1

0

0

0

0

APJlike

1

1

1

1

0

0

0

0

Bombesin

1

1

1

1

0

0

0

0

Bradykinin

1

1

1

1

0

0

0

0

C5aanaphylatoxin

1

1

1

1

0

0

0

0

CCK

1

0.89

1

0.89

0

0.11

0

0.11

0.5

0.8

0.5

0.8

0.5

0.2

0.5

0.2

Chemokine

1

0.55

0.98

0.55

0

0.09

0.02

0.11

Dopamine

0.87

0.91

0.87

0.91

0.13

0.09

0.13

0.09

Endothelin

1

1

1

0.88

0.29

0

0.29

0.13

Fmet_leu_phe

1

1

1

1

0

0

0

0

0.86

1

0.86

1

0.14

0

0.14

0

GABA_Bsubtype1

1

1

1

1

0

0

0

0

GABA_Bsubtype2

1

1

1

1

0

0

0

0

Galaninlike

1

1

1

1

0

0

0

0

GP40like

1

1

1

0.5

0

0

0

0.5

0.76

0.73

0.76

0.73

0.24

0.27

0.24

0.27

Growthhormonesecretagoguelike

1

1

1

1

0

0

0

0

Growthhormonesecretagogue

1

1

1

1

0

0

0

0

Histamine

1

1

1

1

0

0

0

0

Interleukin_8

1

1

1

1

0

0

0

0

LeukotrieneB4receptorBLT1

1

1

1

1

0

0

0

0

Lutropin_choriogonadotropichormone

1

1

1

1

0

0

0

0

Melanocortin

1

1

1

1

0

0

0

0

MetabotropicglutamategroupIII

1

1

1

1

0

0

0

0

MetabotropicglutamategroupII

1

1

1

1

0

0

0

0

MetabotropicglutamategroupI

1

1

1

1

0

0

0

0

Metabotropicglutamateother

1

1

1

1

1

1

1

1

Adrenoceptors

Chemokinereceptor_like

Folliclestimulatinghormone

GPR

Page 12 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

Table 2: Coverage (percentage of True Positives identified before the first False Positive) and the average percentage of errors per
sequence at the MEP of HMM-d and HMM-ModE for classification of Level-2 sub-families of Class A and Class C GPCR proteins

NeuropeptideY

0.88

1

0.88

1

0.13

0

0.13

0

Neurotensin

1

1

1

1

0

0

0

0

Octopamine

0.29

1

0.29

1

0.71

0

0.71

0

OlfactoryIIfam10

1

1

1

1

0

0

0

0

OlfactoryIIfam1

0.86

0.80

0.86

0.80

0.14

0.10

0.14

0.10

OlfactoryIIfam2

1

1

0.88

1

0

0

0.13

0

OlfactoryIIfam3

1

1

1

1

0

0

0

0

OlfactoryIIfam5

1

0.71

1

0.71

0

0.29

0

0.29

OlfactoryIIfam6

0.83

1

1

1

0.17

0

0

0

OlfactoryIIfam7

1

1

1

0.86

0

0

0

0.14

OlfactoryIIfam8

1

1

1

1

0

0

0

0

Opioid

1

1

1

1

0

0

0

0

Orexin_neuropeptideFF

1

1

1

1

0

0

0

0

PlateletADP_KI01receptors

1

1

1

1

0

0

0

0

Prostacyclin

1

1

1

1

0

0

0

0

Prostaglandin

1

1

1

1

0

0

0

0

Proteinase_activatedlike

1

1

1

1

0

0

0

0

Purinoceptors

1

1

0.91

1

0

0

0.09

0

RDC1

1

1

1

1

0

0

0

0

RhodopsinArthropod

1

1

1

1

0

0

0

0

RhodopsinMollusc

0.6

1

0.6

1

0.4

0

0.4

0

RhodopsinOther

0.86

0.67

0.71

0.50

0.14

0.33

0.29

0.50

1

1

1

1

0

0

0

0

0.94

0.94

0.94

0.94

0.06

0.06

0.06

0.06

1

1

1

1

0

0

0

0

0.92

1

0.92

1

0.08

0

0.08

0

Thromboxane

1

1

1

1

0

0

0

0

Thyrotropin_releasinghormone

1

1

1

1

0

0

0

0

Thyrotropin

1

1

1

1

0

0

0

0

UrotensinII

1

1

1

1

0

0

0

0

Vasopressin_like

1

1

1

1

0

0

0

0

Masproto_oncogene

1

1

1

1

0

0

0

0

GPR37_endothelinB_like

1

1

1

1

0

1

0

1

0.95

0.97

0.94

0.95

0.06

0.05

0.07

0.07

RhodopsinVertebrate
Serotonin
Somatostatin
Tachykinin

Average
Average(set0,set1)

0.96

0.95

0.06

0.07

Page 13 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

2.7.1.32 Choline kinase
2.7.1.37 Protein kinase
2.7.1.38 Phosphorylase kinase
2.7.1.39 Homoserine kinase
2.7.1.67 1-phosphatidylinositol 4-kinase
2.7.1.72 Streptomycin 6-kinase
2.7.1.82 Ethanolamine kinase
2.7.1.87 Streptomycin 3"-kinase
2.7.1.95 Kanamycin kinase
2.7.1.100 5-methylthioribose kinase

protein S/T-Y kinase/
atypical protein
kinase:
COG0478,
COG2112,
PF00069, PF00454,
PF01163, PF01633
22074 sequences

2.7.1.103 Viomycin kinase
2.7.1.109 [Hydroxymethylglutaryl-CoA
reductase (NADPH2)] kinase
2.7.1.112 Protein-tyrosine kinase
2.7.1.116 [Isocitrate dehydrogenase (NADP+)] kinase
2.7.1.117 [Myosin light-chain] kinase
2.7.1.119 Hygromycin-B kinase
2.7.1.123 Calcium/calmodulin-dependent protein kinase
2.7.1.125 Rhodopsin kinase
2.7.1.126 [Beta-adrenergic-receptor] kinase
2.7.1.129 [Myosin heavy-chain] kinase
2.7.1.135 [Tau protein] kinase
2.7.1.136 Macrolide 2'-kinase
2.7.1.137 1-phosphatidylinositol 3-kinase
2.7.1.141 [RNA-polymerase]-subunit kinase
2.7.1.153 Phosphatidylinositol-4,5-bisphosphate 3-kinase
2.7.1.154 Phosphatidylinositol-4-phosphate 3-kinase

Group 1:
protein S/T-Y
kinase/atypical
protein kinase/
lipid kinase/
ATP-grasp
23124 sequences

2.7.1.68 1-phosphatidylinositol-4-phosphate 5-kinase

lipid kinase: PF01504
321 sequences

ATP-grasp: PF01326
729 sequences

2.7.1.127 1D-myo-inositol-trisphosphate 3-kinase (*)
2.7.1.140 Inositol-tetrakisphosphate 5-kinase
2.7.1.149 1-phosphatidylinositol 5-phosphate 4-kinase
2.7.1.150 1-phosphatidylinositol 3-phosphate 5-kinase
2.7.1.151Inositol-polyphosphate multikinase
2.7.4.21 Inositol-hexakisphosphate kinase

2.7.1.134 Inositol-tetrakisphosphate 1-kinase
2.7.9.1 Pyruvate, phosphate dikinase
2.7.9.2 Pyruvate, water dikinase

Group

Family and PFAM/COG members

Kinase Activity (E.C.)

Figure 7
An outline of the S/T-Y kinase/atypical kinase/lipid kinase/ATP-grasp Fold Group as categorized in [23]
An outline of the S/T-Y kinase/atypical kinase/lipid kinase/ATP-grasp Fold Group as categorized in [23]. The EC
numbers for which training sequences were available in the ENZYME database are marked in bold.

Page 14 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

Table 3: Application of HMM-d, HMM-t, HMM-ModE and HMM-Sub for function-specific classification of the S/T-Y kinase/atypical
kinase/lipid kinase/ATP-grasp fold family

HMM-d
2.7.1.100
2.7.1.116
2.7.1.117
2.7.1.123
2.7.1.125
2.7.1.126
2.7.1.129
2.7.1.137
2.7.1.32
2.7.1.38
2.7.1.39
2.7.1.67
2.7.1.68
2.7.1.82
2.7.1.95
2.7.9.1
2.7.9.2

HMM-t

HMM-ModE

HMM-Sub

19
43
103
3392
295
96
5
135
93
2634
260
57
36
45
19
171
111

16(0)
43(4)
103(8)
529(120)
11(4)
34(2)
5(0)
135(29)
64(23)
22(4)
260(54)
57(15)
36(15)
31(10)
19(3)
169(55)
107(10)

*
*
*
934(203)
11(4)
34(2)
*
*
*
22(4)
*
*
*
*
*
*
*

*
*
*
3264
259
37
*
*
*
109
*
*
*
*
*
*
*

The numbers in the parentheses for HMM-ModE and HMM-t are the total counts of sequences annotated as hypothetical, putative, unknown and
unnamed which have been classified by the two protocols. A "*" in the HMM-ModE and HMM-Sub columns indicates that the number of false
positive sequences picked up by the HMMER profile from the negative training data were not sufficient to build a false positive profile.

exercise. These sets were manually inspected and were
found to contain sequences whose accession numbers
had either been deleted from the GenBank database or
had been changed. The deleted entries were removed from
the sequence sets and the changed entries were used to
replace the old entries. Some other sequences which were
found to have annotations of "probable", "putative" or
"hypothetical" GPCRs were also removed. This resulted in
a total of 542 sequences in set0 and 541 sequences in set1,
respectively, which covered 65 level-2 subfamilies. The
sequences for set0 were used as training sets and the
HMM-d and HMM-ModE profiles were used to score the
sequences in set1. The same procedure was repeated with
set1 sequences as training sets and an average coverage
and percentage errors per sequence at the Minimum Error
Point (MEP) were calculated as in [19].
Protein Kinases previously classified upto the fold and
family level by Cheek et al [23], were classified at the level
of specific function as described by the Enzyme Commission (EC) numbers (Figure 7). The fold group of S/T-Y
protein kinases/atypical kinases/lipid kinase/ATP-grasp
sequences includes a total of 36 enzymatic activities of
which 19 activities have 3 or more SWISSPROT sequences
associated with them. Two enzymatic activities, "Protein
kinase" and "Protein Tyrosine kinase" were ignored
because they appear to be supersets of various other activities. The SWISSPROT sequences for each EC number were
used to train HMMER and HMM-ModE profiles. These
profiles were then used to classify 56,144 protein kinase
sequences[23] obtained from the NCBI protein database.

Identification of optimal cut-off score using crossvalidation
The sequences were aligned using MUSCLE [26]. Hidden
Markov Model (HMM) profiles were made from each of
the multiple alignments by using program hmmbuild from
the HMMER package version 2.3.2 [4]. The true positives
and false positives were identified by scoring the
sequences with the generated HMMER profiles using
hmmsearch. In our study, we define True Positives (TP) as
those protein sequence which perform the same specific
function, that is, belong to the same specific subfamily
with a score above the threshold value. A protein
sequence from any of the other sub-families that has a
score above the threshold, is considered as a False Positive
(FP).

Ten-fold cross validation was used on each of the six subfamilies for identifying an optimal discrimination threshold which would be used to classify the sequences with
the HMMER profiles as well as with HMM-ModE. Each
sub-family was divided into 10 samples of training and
test sequences in the ratio 9:1 respectively, such that each
sequence in a sub-group was a part of a test set at least
once. Each training sample for each sub-family was further divided into 10 training and test sets using the same
criteria as above. For each sub-family, the test set containing its own sequences was treated as a positive test while
the corresponding test sets of the other groups were
merged to form a negative test. The HMMER profiles and
the HMM-ModE profiles generated from each of these
training sets for each sample were used to score the corresponding positive and negative test sequences. The sensi-

Page 15 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

http://www.biomedcentral.com/1471-2105/8/104

tivity, specificity and MCC (Matthews Correlation
Coefficient)[22] distributions for 10 sets of each sample
were obtained. An average MCC distribution for the 10
sets for a particular sample was plotted as a function of the
scores. The optimal discrimination threshold was identified as the mid point corresponding to the mode valueof
the average MCC distribution. The sequences in the each
test sample for each sub-family were scored with HMMER
and HMM-ModE profiles generated from the entire training sample using the optimal threshold score. The complete protocol is automated using PERL scripts along with
the datasets are available from [37].

Authors' contributions
PKS and DKD wrote programs for the modification of
emission probabilities, SN worked on the cross-validation
and on modularising the final code, AML guided the
implementation of the work. All the authors jointly wrote
the manuscript.

Acknowledgements
DKD is the recipient of a UGC Senior Research Fellowship.

References
1.
2.

Modifying the Emission probabilities of the HMMs (HMMModE)
The false positive (FP) set of sequences were aligned using
MUSCLE. Profile alignment of the subfamily profile and
the FP profile was performed using the -profile option of
MUSCLE. HMMs for the aligned sub-family and FP alignments were built as described above. For nullifying the
non-discriminating fold-specific emission probabilities
the match emission probabilities of the true positive profile were modified with the emission probabilities of the
FP profile using the equations described in the HMMER
user's guide [24]. Specifically, the score in the HMM is
modified using the condition

Score = integer( floor(0.5 + (Intscale ∗ log 2 (

P
))))
Pnull

3.

4.
5.

6.
7.
8.
9.

where Intscale = 1000

10.

Probabilities can be derived from the scores using

11.

P = Pnull

Score
Intscale
∗2

The modification steps and the generation of the new
HMM in the HMMER format was accomplished using
PERL scripts.

12.
13.
14.
15.

Abbreviations used
HMM, Hidden Markov Model; HMM-d, Profile HMM
used with default HMMER threshold; HMM-t, Profile
HMM used with optimised discrimination threshold;
HMM-ModE, Profile HMM with modified emission probabilities; HMM-Sub, log-difference-of-odds-scores; AGC,
cAMP dependent protein kinase/protein kinase G/protein
kinase C family; PKA, cAMP dependent protein kinase;
PKC, Protein Kinase C; RAC, protein kinases related to
PKA and PKC;GRK, G-Protein Coupled Receptor Kinase;
S6PK, ribosomal S6 Protein Kinase; PVPK1, Flowering
plant Protein Kinase; ROC, Receiver-Operator Characteristic; MCC, Matthew's Correlation Coefficient; MEP, Minimal Error Point.

16.
17.
18.
19.
20.

21.

Altschul SF, Gish W, Miller W, Myers EW, Lipman DJ: Basic local
alignment search tool. J Mol Biol 1990, 215:403-410.
Pearson WR, Lipman DJ: Improved Tools for Biological
Sequence Comparison. Proc Natl Acad Sci U S A 1988,
85:2444-2448.
Altschul SF, Madden TL, Schaffer AA, Zhang J, Zhang Z, Miller W, DJ
Lipman: Gapped BLAST and PSI-BLAST: a new generation of
protein database search programs. Nucleic Acids Res 1997,
25(17):3389-402.
Eddy SR: HMMER: Profile hidden Markov models for biological sequence analysis. 1998 [http://hmmer.janelia.org/].
Wollenberg KR, Atchley WR: Separation of phylogenetic and
functional associations in biological sequences by using the
parametric bootstrap.
Proc Natl Acad Sci U S A 2000,
97(7):3288-3291.
Hegyi H, Gerstein M: The Relationship between Protein Structure and Function: a Comprehensive Survey with Applicationto the Yeast Genome. J Mol Biol 1999, 288:147-164.
Söding J: Protein homology detection by HMM-HMM comparison. Bioinformatics 2005, 21:951-960.
Edgar RC, Sjolander K: COACH: profile-profile alignment of
protein families using hidden Markov models. Bioinformatics
2004, 20(8):1309-1318.
Gough J, Karplus K, Hughey R, Chothia C: Assignment of Homology to Genome Sequences using a Library of Hidden Markov
Models that Represent all Proteins of Known Structure. J Mol
Biol 2001, 313(4):903-919.
Murzin AG, Brenner SE, Hubbard T, Chothia C: SCOP: a structural
classification of proteins database for the investigation of
sequences and structures. J Mol Biol 1995, 247:536-540.
Bateman A, Coin L, Durbin R, Finn RD, Hollich V, Griffiths-Jones S,
Khanna A, Marshall M, Moxon S, Sonnhammer ELL, Studholme DJ,
Yeats C, Eddy SR: The Pfam Protein Families Database. Nucleic
Acids Res 2004:D138-D141.
Brown D, Sjolander K: Functional classification using phylogenomic inference. PLoS Comput Biol 2006, 2(6):e77.
Brown D, Krishnamurthy N, Dale JM, Christopher W, Sjolander K:
Subfamily HMMS in Functional Genomics. Pacific Symposium on
Biocomputing 2005, 10:322-333.
Gene Ontology: tool for the unification of biology. The Gene
Ontology Consortium. Nature Genet 2000, 25:25-29.
Mamitsuka H: A learning method of hidden Markov models for
sequence discrimination. J Comput Biol 1996, 3:361-3.
Wistrand M, Sonnhammer EL: Improving Profile HMM Discrimination by Adapting Transition Probabilities. J Mol Biol 2004,
338:847-854.
Hannenhalli S, Russel RB: Analysis and Prediction of Functional
Sub-types from Protein Sequence Alignments. J Mol Biol 2000,
303:61-76.
Jaakkola T, Diekhans M, Haussler D: A discriminative framework
for detecting remote protein homologies. J Comput Biol 2000,
7(1–2):95-114.
Karchin R, Karplus K, Haussler D: Classifying G-protein coupled
receptors with support vector machines. Bioinformatics 2002,
18(1):147-159.
Horn F, Mokrane M, Weare J, Vriend G: G-protein coupled receptors or the power of data. In Genomics and Proteomics: Functional
and Computational Aspects Kluwer Academic/Plenum, Norwell, MA;
2000:191-214.
Kohavi R: A Study of Cross- Validation and Bootstrap for
Accurate Estimation and Model Selection. International Joint
Conference on Artificial Intelligence (IJCAI) 1995.

Page 16 of 17
(page number not for citation purposes)

BMC Bioinformatics 2007, 8:104

22.
23.
24.
25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.
37.

http://www.biomedcentral.com/1471-2105/8/104

Baldi P, Brunak S, Chauvin Y, Andersen Claus AF, Neilsen H: Assessing the accuracy of prediction algorithms for classification:
an overview. Bioinformatics 2000, 16(5):412-424.
Cheek S, Ginalski K, Zhang H, Grishin NV: A comprehensive
update of the sequence and structure classification of
kinases. BMC Structural Biology 2005, 5:6.
HMMER user's guide: biological sequence analysis using profile hidden Markov models [ftp://selab.janelia.org/pub/software/
hmmer/CURRENT/Userguide.pdf]
Yu Y, Bundschuh R, Hwa T: Hybrid alignment: high-performance with universal statistics.
Bioinformatics 2002,
18(6):864-872.
Edgar RC: MUSCLE: Multiple sequence alignment with high
accuracy and high throughput.
Nucleic Acids Res 2004,
32(5):1792-1797.
Shannon C, Weaver W: Mathematical Theory of Communication. University of Illinois press, Champaign, IL; 1963.
Durbin R, Eddy S, Krogh A, Mitchison G: Biological Sequence
Analysis: Probablistic Models of Protein and Nucleic Acids.
Cambridge University Press, Cambridge, UK; 1998.
Wu G, Fiser A, ter Kuile B, Miklos M: Convergent evolution of
Trichomonas varginalis lactate dehydrogenase from malate
dehydrogenase. Proc Natl Acad Sci U S A 1999, 96:6285-6290.
Wistrand M, Sonnhammer EL: Improved profile HMM performance by assessment of critical algorithmic features in SAM
and HMMER. BMC Bioinformatics 2005, 6:99.
Hanks SK, Hunter T: Protein kinases 6. The eukaryotic protein
kinase superfamily: kinase (catalytic) domain structure and
classification. The FASEB Journal 1995, 9:576-596.
Huse M, Kuriyan J: The Conformational Plasticity of Protein
Kinases. CELL 2002, 109:275-282.
Bouvier M: Structural and functional aspects of a protein-coupled receptor oligomerization. Biochem Cell Biol 1998, 76:1-11.
Bairoch A: The ENZYME database in 2000. Nucleic Acids Res
2000, 28:304-305.
Li L, Shakhnovich EI, Mirny LA: Amino acids determining
enzyme-substrate specificity in prokaryotic and eukaryotic
protein kinases. Proc Natl Acad Sci U S A 2003, 100(8):4463-4468.
Barton GJ: ALSCRIPT: a tool to format multiple sequence
alignments. Protein Eng 1993, 6(1):37-40.
[http://www.jnu.ac.in/Faculty/andrew/].

Publish with Bio Med Central and every
scientist can read your work free of charge
"BioMed Central will be the most significant development for
disseminating the results of biomedical researc h in our lifetime."
Sir Paul Nurse, Cancer Research UK

Your research papers will be:
available free of charge to the entire biomedical community
peer reviewed and published immediately upon acceptance
cited in PubMed and archived on PubMed Central
yours — you keep the copyright

BioMedcentral

Submit your manuscript here:
http://www.biomedcentral.com/info/publishing_adv.asp

Page 17 of 17
(page number not for citation purposes)

</pre>
</body>
</html>
