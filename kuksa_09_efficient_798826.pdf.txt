<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>1471-2105-10-S14-S9 1..18</title>
<meta name="Creator" content="Arbortext Advanced Print Publisher 9.0.220/W Unicode"/>
<meta name="Producer" content="Acrobat Distiller 8.1.0 (Windows)"/>
<meta name="CreationDate" content=""/>
</head>
<body>
<pre>
BMC Bioinformatics

BioMed Central

Research

Open Access

Efficient alignment-free DNA barcode analytics
Pavel Kuksa and Vladimir Pavlovic*
Address: Department of Computer Science, Rutgers University, Piscataway, NJ 08854, USA
E-mail: Pavel Kuksa - pkuksa@cs.rutgers.edu; Vladimir Pavlovic* - vladimir@cs.rutgers.edu
*Corresponding author

Published: 10 November 2009
BMC Bioinformatics 2009, 10(Suppl 14):S9

doi: 10.1186/1471-2105-10-S14-S9

This article is available from: http://www.biomedcentral.com/1471-2105/10/S14/S9
Publication of this supplement was made possible thanks to sponsorship from the Encyclopedia of Life and the Consortium for the Barcode of Life.
© 2009 Kuksa and Pavlovic; licensee BioMed Central Ltd.
This is an open access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/2.0),
which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

Abstract
Background: In this work we consider barcode DNA analysis problems and address them using
alternative, alignment-free methods and representations which model sequences as collections of
short sequence fragments (features). The methods use fixed-length representations (spectrum) for
barcode sequences to measure similarities or dissimilarities between sequences coming from the
same or different species. The spectrum-based representation not only allows for accurate and
computationally efficient species classification, but also opens possibility for accurate clustering
analysis of putative species barcodes and identification of critical within-barcode loci distinguishing
barcodes of different sample groups.
Results: New alignment-free methods provide highly accurate and fast DNA barcode-based
identification and classification of species with substantial improvements in accuracy and speed over
state-of-the-art barcode analysis methods. We evaluate our methods on problems of species
classification and identification using barcodes, important and relevant analytical tasks in many
practical applications (adverse species movement monitoring, sampling surveys for unknown or
pathogenic species identification, biodiversity assessment, etc.) On several benchmark barcode
datasets, including ACG, Astraptes, Hesperiidae, Fish larvae, and Birds of North America, proposed
alignment-free methods considerably improve prediction accuracy compared to prior results. We
also observe significant running time improvements over the state-of-the-art methods.
Conclusion: Our results show that newly developed alignment-free methods for DNA barcoding
can efficiently and with high accuracy identify specimens by examining only few barcode features,
resulting in increased scalability and interpretability of current computational approaches to
barcoding.

Background
Identification of living species is one of the pressing tasks
in science and technology today, prompted by our need
to understand the natural biodiversity and its increasing
interaction with the human society.

However, development of comprehensive species identification strategies is impeded by the enormous biodiversity of life on Earth. Traditional morphological
identification of species is difficult, requires expertise of
highly trained taxonomists, and takes up enormous

Page 1 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

amounts of time. Species identification methods based
on molecular diagnostic technologies, including PCR,
are limited in the number of species they can identify
and lack standardization of technologies or are susceptible to tissue conditions. DNA barcoding has been
recently introduced as a taxonomic tool for characterizing species using fragments of a DNA sequence from
standard gene regions, such as the mitochondrial DNA
(mtDNA) [1]. These relatively short sequences (about
650 symbols in the case of mtDNA) are used as markers
for discerning taxonomical identities of specimens using
the process of mtDNA extraction, fragment amplification, sequencing and database lookup [2]. A critical
property of this particular region is its monophyletic
association: the content of mtDNA is often preserved
within a species and shows greater divergence between
than within species (sometimes 10× or more when sister
species are excluded) [3]. In particular, a region
corresponding to c oxidase subunit 1 or cox1 gene is
often used as a critical barcoding marker [1] that exhibits
such properties.
Barcoding has shown great promise in practice. DNA
barcodes can offer increased adaptability, robustness,
and predictive value for rapid and accurate identification
of species. For instance, barcoding analysis can result in
improved correct placement of previously unknown
species or increased resolution of specimens [4],
identification of fish products with high accuracy [5],
substitutes in fish species for human consumption [6] or
marketing of endangered specimens [7]. DNA barcoding
has been applied with great initial success to identification across the spectrum of living species, from algea [8],
fungi [8], bacteria [9], to plants [10-12], spiders [13], fish
[14], birds [1], and rats [15].
Most current barcoding computational methods leverage
established modeling approaches from molecular phylogenetic analysis. Traditional barcoding methods, c.f.,
[1,16], are essentially tree-based phylogenetic
approaches where identification decisions are made
using a-priory threshold on the tree-induced distances.
Choosing an optimal threshold is a challenging task,
affected by variable relationship between the species
morphology and the cox1 content similarity. More
recently, sophisticated Bayesian and decision theory
approaches [17,18] have been proposed that attempt
to address this problem in a more systematic manner.
Traditional phylogenetic methods are also sensitive to
the choice of the sequence similarity metrics and the
presence of exogenous variations in the sequence (such
as those caused by bacterial cosegregation). Moreover,
methods of molecular phylogeny are not inherently
aimed at the task of sequence delineation, rather the
study of relationships at different points in evolutionary

http://www.biomedcentral.com/1471-2105/10/S14/S9

history. As a consequence, they can also sometimes
exhibit high computational complexity, justified for the
complex analysis task but often unnecessary when the
goal is e.g., species identification.
More recently, methods that more directly tackle the
problem of barcode-based identifications have emerged.
Some of these methods, such as [16] use the tools of
generic but widely available and highly computationally
optimized biological sequence comparison (BLAST or
PSI-BLAST). Approach such as [19] even more immediately focuses on the prediction problem. However, a
number of challenges remain to be addressed, including
the accuracy of identification [16,18,20,21], as well as
the efficiency and scalability of computational methods.
In this study we investigate alignment-free kernel methods
for the DNA barcoding. Kernel-based classification has
demonstrated strong performance in many related tasks
of biological sequence analysis, such as protein classification and remote homology detection [22-24]. In the
process, a number of kernel types or similarity measures
between sequences have been proposed, including
kernels derived from probabilistic models [25], k-mer
string kernels [22,23], and weighted-decomposition
kernels [26]. In this work we focus on k-mer string
kernels, and in particular the spectrum/mismatch kernel
methods. In our approach, species identification is
performed by first transforming variable-length
sequences into fixed-length representations (string spectra) and then classifying resulting spectral representations into one of many established species classes using
state-of-the-art classification algorithm (e.g. nearest
neighbor or Support Vector Machine (SVM) classifiers
[27,28]). As a result, the alignment free kernel-based
species identification in our study demonstrates both
high accuracy, improved speed and classification performance compared to previously employed DNA barcoding identification methods.

Methods
In this section we discuss alignment-free analytics that
we propose to use for accurate and efficient multi-class
classification and identification of barcode sequences.
The spectrum kernel methods
Varying sequence length as well as the warping processes
within sequences (insertions/deletions) typically preclude direct application of efficient computational
models and algorithms designed for data in Euclidean
spaces. The spectrum kernel methods [29,30] resolve this
problem using fixed-length representations of arbitrary
long sequences. These representations or features describe
the statistics of short substrings of length k, also known

Page 2 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

as k-mers, contained in the original sequence. Such
representations are both efficient to compute and
informative for the tasks of sequence analysis.
Consider a sequence X of length n represented as a string
of symbols (x1, x2,..., xn) from some alphabet Σ, xi Œ Σ. In
the case of DNA sequences this alphabet consists of the
set of the four DNA bases, {A, C, T, G}. Spectrum
methods construct a fixed-length feature vector F(X)
from this arbitrary long sequence by counting the
frequencies of occurrence of all k-mers xi, xi+1,..., xi+k-1
in X. This feature, the histogram of k-mers in X, is
commonly referred to as the sequence spectrum. The
spectrum’s domain has the dimension |Σ|k corresponding to the total number of all possible fragments of
length k and, as a result, induces a fixed length
representation.

http://www.biomedcentral.com/1471-2105/10/S14/S9

This concept is illustrated in Figure 1. A sequence from
the Astraptes set is represented as the histogram of
frequencies with which 5-long fragments (5-mers) occur
in that sequence. In the case of 5-mers there are Σk = 45 =
1024 such possible fragments, some of which are
identified on the horizontal axes of the count plots in
Figure 1. For instance, the fragment “CCGCG” occurs
three times. Hence, the Astraptes sequence is mapped to
a 1024-dimensional fixed-length representation. This
representation will be subsequently used to judge
similarities and dissimilarities between pairs of
sequences coming from the same or different species.
In practice the spectrum mapping will produce sparse
feature vectors of counts when either k is long or the
sequences are short. On average and assuming a random
sequence generation process, for a sequence of length n

Figure 1
Illustration of spectrum and mismatch features.

Page 3 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

each feature will appear n/|Σ|k times. While the use of
larger k is preferred to yield higher specificity of features,
it inadvertently can lead to representations or feature
spaces that are too high dimensional and produce low
similarity even between sequences in the same class
(species). As a consequence, it is often necessary to
increase the “density” of these features to allow sufficient
within-class sensitivity while maintaining the specificity
across classes.
Increasing density for a fixed k-mer length can alternatively be viewed as the process of inexact sequence
matching. The mismatch kernel method [29] accomplishes this task using the following general mismatch(k,
m) |Σ|k-dimensional representation of sequence X:

(1)
where Im(a, g) = 1 if a Œ N (g, m) and N(g, m) denotes
the set of contiguous substrings of length k that differ
from g in at most m positions. In other words, in
addition to counting all k-mers a present in sequence X,
one also adds counts of k-mers that differ in at most
m symbols from each a. This process is illustrated in
Figure 1 where 5-mer “GGAAT” is mapped to a set of
·(|Σ|m - 1) + 1 = 5 × 3 + 1 = 16 similar k-mers, at
most one symbol (m = 1) different from “GGAAT”. The
induced feature vector Fk, m(X) has the same dimension
as the regular spectrum feature F(X), but is “denser”. The
choice of the maximum number of the mismatches (m)
allowed between any two particular k-mers typically
depends on whether sequences are relatively similar
(e.g. closely related families, m is small) or are far apart
(e.g. remote homologs, large values of m may be
needed). The exact spectrum kernel is a particular case
of the mismatch kernel and can be obtained from Eq. 1
by setting the number of mismatches m to zero (this will
result in counting only exact matches between k-mers).
Both mismatch and exact spectrum methods measure
similarity of sequences by comparing the fixed-length
features Fk, mof those sequences without performing any
sequence alignment. As we discuss in the next section,
the computational cost of evaluating this similarity is
linear in the length of the sequences, compared to
quadratic complexity required by alignment-based methods (e.g. Smith-Waterman) for similarity evaluation.
This leads to a potentially important advantage for these
methods when applied to large DNA barcode sets, which
we demonstrate empirically in our Results.
Alignment-free algorithms
Both mismatch and spectrum methods typically evaluate
similarity K(X, Y) of a pair of sequences by computing

the dot-product between their corresponding feature
vectors (Eq. 1):

(2)
Direct evaluation of the dot-product above for similarity
computation results in costly O(|Σ|kn) complexity. To
efficiently evaluate the dot-product, we first note that in
Eq. 2 the product Im(a, g)Im(b, g) is non-zero (i.e.
contributes to the total similarity/kernel value) only if g
is the neighbor for both a and b. We then write the dotproduct (Eq. 2) as follows:

(3)
where Ik, m(a, b) is the number of k-mers g shared by a
and b. We observe that the number of shared k-mers Ik,
m(a, b) depends on the Hamming distance (i.e., the
number of differences, in symbols, between the strings) d
(a, b) between a and b for a fixed alphabet Σ, the length
of the k-mer k, and the number of mismatches m (i.e. Ik,
m(a, b) can only have a fixed set of values with each
value corresponding to a particular Hamming distance).
Since the maximum Hamming distance that will result in
the non-zero Ik, m(a, b) is 2m, the dot-product in Eq. 3
reduces to computing the number of pairs (a, b), a Œ X,
b Œ Y, for each of possible Hamming distances from 0
to 2m:

(4)
As we show in [31], the mismatch/spectrum similarity
measure in the form as in Eq. 4 can be efficiently
computed in O(ck, mn) time, where ck, m is a constant that
depends only on the k-mer length and the maximum
number of allowed differences m but not on the
sequence length n. In the case of the exact spectrum
method, the complexity is O(kn), i.e. is linear in both the
sequence length n and the k-mer length k. It is also
important to note that we typically need to evaluate this
similarity for a set of N sequences (e.g., DNA barcode
samples). Instead of evaluating similarity for every pair
of N sequences, a task proportional to N2, in [31] we also
show that this can be accomplished in the time linear in
N. Hence, the overall complexity of evaluating the
mismatch(k, m) similarity on a set of N sequences of
maximal length n is O(ck, mnN). This results in significant
computational savings (speedup) when it is necessary to
compute similarity among a large number of sequences,
as may be the case with DNA barcodes.

Page 4 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

Prediction models
Given the similarity kernel for any pair of sequences, one
can consider several predictive tasks. One such task is the
classification of new sequence samples into one of the
previously seen classes. In the context of DNA barcoding,
this task can be interpreted as either the classification of
a barcode sample into one of the known species or the
verification task of resolving whether the sample belongs
to a particular species or not. We first consider the latter
(verification) task and then generalize it to the full
classification task. A very general class of predictive
models that relies on the similarity metric induced by the
kernel K computes the matching score between the query
sequence X and the previously seen sequences {X1,...,
XN} whose class assignments {y1,..., yN} are known. The
score is formed as

(5)
The sign of this score then typically indicates whether the
query X belongs to a particular class, f(X) > 0, or not. The
weights wi are set in a training procedure prior to making
predictions using a variety of available “learning”
algorithms that attempt to optimize the predictive
performance of this model. This verification model can
also be generalized to the classification setting, where the
sample is to be classified in one of M possible classes. In
that case one can construct the predictive model for each
class, fm(X) = Σiwm, iK(X, Xi), and make the final
prediction by finding the class with the maximum
score, y* = arg maxm fm(X).
In this work we consider two classes of algorithms that
have generally shown state-of-the-art performance on
prediction tasks. One is the simple Nearest Neighbor
classifier. In that setting wm, i is non-zero, i.e. wm, i = 1,
only for the sequence Xi (of class yi = m) which is
“closest”, or most similar, to the query sequence X.
Nearest neighbor classifiers are simple and have appealing (asymptotic) theoretical properties.
The second class of learning algorithms used in this work
is the well-known Support Vector Machine [28]. In the
view of the model above the SVM selects an optimal
subset of training sequences Xi (the so-called support
vectors) and sets their weights to maximize the models
predictive accuracy. In our work we use the “one-vs-rest”
SVM learning approach described in [32].

Results and discussion
To demonstrate the utility of the alignment-free
sequence representation for DNA barcode analytics we
primarily focus on the task of species identification. The

identification or classification task is one of the relevant
analytical problems considered so far in DNA barcoding
[16,18,20,21]. In this section we show that the spectrumbased, alignment-free representation possesses several
interesting properties, among them the high accuracy of
the sample-to-species assignments as well as the computational efficiency. Moreover, the spectral representations
offer interesting insights into which sequence markers/
features within the standard barcode region (e.g. cox1)
serve as the most important discriminants among the
sets of species. This result has further implication on
computational efficiency but may also facilitate further
taxonomical studies. We perform the barcode-based
species classification experiments using several benchmark barcode datasets from various barcode collecting
campaigns for mammals, fish, birds, lepidoptera, etc. In
particular, we use seven data sets of DNA barcodes
including Astraptes (12 species), Hesperiidae (364
species), Bats of Guyana (96 species), Fish of Australia
(211 species), Birds of North America (656 species),
ACG (573 species), and Fish larvae (7 species). Astraptes,
Hesperiidae, Bats of Guyana, Birds of North America,
and Fish of Australia were compiled from the BOLD [33]
project. ACG set was published as a part of [34]. The Fish
larvae set appeared in [16]. Table 1 summarizes details
of these datasets.
Using these datasets, we consider barcode class prediction problem as a multi-class classification problem
described in the Methods section. For the SVM prediction approach, we use one-vs-rest setting to perform the
multi-class classification using binary predictors for each
class. We evaluate alignment-free similarity of DNA
barcodes using the spectrum/mismatch representations
of Section ‘The spectrum kernel methods’ and contrast it
to several standard similarity metrics employed for
biological sequences and DNA barcodes in particular.
In all experiments, we normalize the similarity/
kernel values K(X, Y) using K’(X, Y) = K(X, Y)/
to remove the dependency between
the kernel value and the sequence length. To perform our
experiments, we use an existing SVM implementation
from a standard machine learning package SPIDER [35]
with default parameters. For the spectrum/mismatch
Table 1: Barcode datasets

Dataset

# species

# barcodes

ACG
Hesperiidae
Astraptes
Bats of Guyana
Birds of North America
Fish of Australia
Fish larvae

573
364
12
96
656
211
7

4267
2185
465
840
2589
754
35

Page 5 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

kernel, we use mismatch(5,1) (k = 5, and m = 1) and
spectrum-10 (k = 10) kernels. To facilitate experiments
on large datasets, we use the kernel computation
algorithms proposed by Kuksa et al. in [31]. The data
and source code used in our experiments are available at
the supplementary website [36].
In the following, we first present results on multi-class
species identification problem using alignment-free
methods. We then focus on the analysis of withinbarcode markers and show the impact of the marker
selection on the identification accuracy. To illustrate the
ability of the similarity metric to reduce the withinspecies dispersion while maintaining separability of
different species we use clustering analysis in the set of
experiments following the marker study. Finally, we
provide empirical running time analysis of our proposed
approach and contrast it with some state-of-the-art
methods.
Species identification
In the species identification experiments, we use the
nearest neighbor classifier and the SVM to predict class
assignments for query barcodes based on similarity
scores computed using alignment-based (Smith-Waterman, Kimura, Hamming) and alignment-free methods
(spectrum and mismatch kernels). To discern the
predictive ability of different methods we consider a
cross-validation setting in which the species data is
randomly split into ten disjoint subsets. Nine of the
subsets are used to estimate the prediction models which
are subsequently evaluated on the remaining set, in a
repeated fashion. We report results averaged over the ten
folds and show the accuracy variation of each method.
Nearest neighbor approach
Classification performance for the nearest neighbor
approach using alignment-free kernel methods is summarized in Table 2 where we compare cross-validation
error rates of the resulting classifiers on the benchmark
barcode datasets. We also report results obtained by
running PSI-BLAST search with default parameters on
these datasets. The results indicate that the alignmentfree spectral method generally shows the highest
Table 2: Nearest neighbor, 10-fold cross-validation error (%)

Dataset

PSI-BLAST

spectrum

3.07 ± 0.68
4.62 ± 0.97
13.82 ± 4.42
1.63 ± 1.22
7.46 ± 1.90
5.62 ± 3.31
2.86

2.49 ± 0.87
3.57 ± 1.08
1.07 ± 1.81
1.63 ± 1.22
6.22 ± 1.50
5.5 ± 3.27
2.86

3.63
4.38
1.50
1.73
7.29
5.29
5.71

In Table 4, we show classification results contrasting the
spectral method with nearest neighbor predictors based
on more traditional, alignment-based similarity measures. We consider methods based on both global and
local alignments. The global alignment on the set of
sequences is obtained using the Needleman-Wunsch
algorithm with NUC44 scoring matrix and gap opening/
extending penalties set to 8. These settings result in
multiple alignments largely identical to those available
via BOLD [33] for the barcode sets of the publicly
available projects we use in our evaluation. Given the
global alignment, the sequence similarity is scored using
two metrics: the Hamming distance (0/1 mismatch/
match score) and the Kimura distance. For local
alignment-based pairwise scores we use the SmithWaterman scoring with the same parameters as the
global alignment model. The results in Table 4 indicate
that the alignment-free spectral similarity yields the
overall most accurate species predictors. The spectral
and Kimura-based distances produce comparable accuracies on three sets (Bats, Birds and Fishes of Australia). As
expected, the Hamming 0/1 scoring is typically inferior
to other methods as it does not include any measure of
varying evolutionary pressures exhibited across different
nucleotide pairs. The ACG and the Fish larvae sets are
both cases where the spectral method achieves the most
accurate prediction among the four contrasted scoring
metrics.

mismatch

ACG
Hesperiidae
Astraptes
Bats
Birds
Fish Australia
Fish larvae

classification accuracy. Compared to PSI-BLAST search,
the mismatch similarity exhibits similar results, typically
inferior to those of the spectral similarity. In Table 3 we
show classification performance of the spectrum method
for different values of k (k-mer length). The error rates
are shown for the nearest neighbor (1-NN) and for 3-NN
and 5-NN classifiers. We observe that the nearest
neighbor classifier displays the lowest error rates
compared to classifiers that use 3 or 5 nearest neighbors
for prediction. As we can see from the table, the
spectrum method is relatively robust to the choice of
the k-mer length, with values of k = 8 - 15 resulting in the
highest classification accuracy. We also note that the
experiments show that the smaller k are satisfactory
and increasing k much does not increase accuracy
significantly; smaller values of the k-mer length also
have lower computational complexity compared to the
larger values of k.

±
±
±
±
±
±

0.65
1.49
1.99
2.01
0.96
3.34

To better assess the predictive ability of different
measures we also compare the ranking quality of the
resulting classifiers on ACG, Hesperiidae, and Birds of
North America data sets in Figures 2, 3, and 4,
respectively. The ranking score can be used to ascertain
how closely the predictions of a model match those of
the ideal case as a function of the model specificity. For

Page 6 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

Table 3: Classification performance of the k-spectrum method using nearest neighbor

dataset

k=3

k=5

k=8

k = 10

k = 15

4.24 ± 0.90
5.32 ± 1.33
1.91 ± 1.87
1.87 ± 1.36
7.77 ± 1.26
5.47 ± 3.26
8.57

3.19 ± 0.93
4.21 ± 1.18
1.90 ± 2.08
1.63 ± 1.22
6.68 ± 1.22
5.35 ± 3.36
5.71

2.58 ± 0.94
3.66 ± 1.07
1.48 ± 1.75
1.63 ± 1.22
6.42 ± 1.34
5.35 ± 3.36
2.86

2.49 ± 0.87
3.57 ± 1.08
1.07 ± 1.81
1.63 ± 1.22
6.22 ± 1.50
5.50 ± 3.27
2.86

2.35 ± 0.83
3.39 ± 0.93
1.07 ± 1.81
1.63 ± 1.22
6.13 ± 1.65
5.50 ± 3.27
2.86

10.20 ± 1.31
15.55 ± 1.25
2.78 ± 2.49
3.77 ± 1.68
20.23 ± 2.64
12.44 ± 5.67
14.29

8.98 ± 1.23
14.30 ± 1.46
2.36 ± 2.16
4.46 ± 2.06
19.58 ± 2.48
12.32 ± 5.68
14.29

8.54 ± 1.11
14.22 ± 1.50
2.36 ± 2.16
4.35 ± 2.01
18.88 ± 2.29
12.31 ± 5.38
11.43

8.67 ± 1.33
14.40 ± 1.85
2.15 ± 2.29
4.46 ± 2.06
18.99 ± 2.22
12.42 ± 5.46
11.43

8.63 ± 1.21
14.30 ± 2.00
1.70 ± 1.96
4.46 ± 2.06
18.37 ± 2.07
11.93 ± 5.06
11.43

13.41 ± 2.00
19.70 ± 1.71
3.43 ± 3.09
6.09 ± 3.01
27.32 ± 2.50
19.40 ± 5.91
22.86

12.42 ± 1.40
19.64 ± 2.62
3.01 ± 2.76
5.85 ± 3.23
26.26 ± 2.17
18.85 ± 6.15
22.86

11.49 ± 1.28
18.63 ± 2.21
2.14 ± 1.74
5.73 ± 2.77
26.49 ± 2.11
19.28 ± 5.28
22.86

11.49 ± 1.25
18.54 ± 2.17
1.70 ± 1.96
5.87 ± 2.94
26.42 ± 2.44
18.36 ± 5.04
22.86

11.28 ± 1.20
18.22 ± 2.17
1.06 ± 1.12
5.61 ± 2.79
26.10 ± 2.36
18.81 ± 4.64
22.86

1-NN (nearest neighbor)
ACG
Hesperiidae
Astraptes
Bats of Guyana
Birds
Fish Australia
Fish larvae
3-NN
ACG
Hesperiidae
Astraptes
Bats of Guyana
Birds
Fish Australia
Fish larvae
5-NN
ACG
Hesperiidae
Astraptes
Bats of Guyana
Birds
Fish Australia
Fish larvae

Table 4: Nearest neighbor performance (10-fold cross-validation error, %)

Dataset

Spectrum

Hamming

Kimura

Smith-Waterman

ACG
Hesperiidae
Astraptes
Bats Guyana
Birds of North America
Fish Australia
Fish larvae†

2.49
3.57
1.07
1.63
6.22
5.50
2.86

11.44 ± 1.52
14.49 ± 2.36
3.61 ± 2.77
2.72 ± 1.83
18.38 ± 2.05
5.87 ± 4.01
11.43

5.51 ± 0.86
3.81 ± 1.26
1.71 ± 1.96
1.63 ± 1.22
6.02 ± 1.36
5.35 ± 3.36
8.57

3.66 ± 0.66
5.45 ± 1.20
1.64 ± 1.03
1.63 ± 1.22
8.20 ± 1.53
5.35 ± 3.36
5.71

†

±
±
±
±
±
±

0.87
1.08
1.81
1.22
1.50
3.27

leave-one-out validation error is reported

instance, the top-3 error rate reports the accuracy of
prediction if one assumes that correct prediction is made
whenever the true species class of a sequence is anywhere
among the top-3 scoring classes predicted by a model.
Top-1 error rate corresponds to the standard error rate.
The higher the q, the lower the top-q errors are, at the
expense of the specificity of predictions. For good
models/similarity measure the ranking error rate typically drops off quickly. In our evaluations we observe
that the alignment-free spectrum method consistently
shows lower top-q error rates (n = 1...10) compared to
that of alignment-based (Kimura, Smith-Waterman,
Hamming) scoring methods (Figures 2, 3, and 4), with
the Kimura score approaching the spectrum for

intermediate values of n on the sets where the two
initially differ. On the ACG set, for instance, the Kimura
distance-based scoring becomes comparable to the
spectrum measure for n = 4, which suggests that further
tuning of the score parameters may improve Kimura
performance. However, doing so would require more
complex, most likely heterogeneous, sequence models.
The above sets of experiments indicate that the alignment-free spectral measure may be well-suited for the
DNA-barcode based species prediction tasks. In contrast
with the alignment methods, the spectral alignment-free
scores leave out the need for sometimes complex and
sensitive global alignments. The benefit becomes more

Page 7 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

12

20

Spectrum
Hamming
Kimura
Smith−Waterman

10

16
top−q error, %

8
top−q error, %

Spectrum
Hamming
Kimura
Smith−Waterman

18

6

4

14
12
10
8

2

0

6

1

2

3

4

5

6

7

8

9

10

q

Figure 2
Ranking quality. Comparison of top-q error rates on ACG
dataset for the spectrum (alignment-free) method and
alignment-based methods.

16
Spectrum
Hamming
Kimura
Smith−Waterman

14

top−q error, %

12
10
8
6
4
2

1

2

3

4

5

6

7

8

9

10

q

Figure 3
Ranking quality. Comparison of top-q error rates on
Hesperiidae dataset for the spectrum (alignment-free)
method and alignment-based methods.

significant if one keeps in mind that any addition of new
sequences to the set may require (global) re-alignments
within a set, the step not necessary in the case of
spectrum scores.
One other particularly interesting conclusion is that the
spectral methods are better than or similar to the
alignment-based scoring metrics even when those
metrics take into account differences in evolutionary

4

1

2

3

4

5

6

7

8

9

10

q

Figure 4
Ranking quality. Comparison of top-q error rates on Birds
dataset for the spectrum (alignment-free) method and
alignment-based methods.

pressures across different sequence symbols, either
imposed by the alignment parameters or the scoring
such as that of the Kimura model. This observation
should be placed in the context of our alignment-free
methods that use the 0/1 scoring but within the short
sequence fragments only. Using such scoring on the full
sequence scale, as in the Hamming distance measure
above, is bound to produce inaccurate species matches.
Another important conclusion is that in the case of
barcodes the mismatch alignment-free measures generally result in similarities that less accurately model the
distribution of sequences within and across different
species compared to the exact spectrum methods. This is
in contrast with other data domains where the mismatch
features have been successfully applied, such as that of
the protein sequences [31]. Two factors play a role in this
discrepancy. The protein sequences, from the point of
our mathematical representation, live in higher-dimensional spaces due to the increased alphabet size (20 vs.
4) and hence may require a looser notion of matching.
Another factor is the variability within classes (species in
barcodes and, e.g., superfamilies in proteins); protein
sequences with the same class typically exhibit much
higher primary sequence variability than do the DNA
barcodes within taxonomic groups. As a consequence,
the mismatch measures may not be deemed necessary
for the DNA barcoding analytics. A final comment relates
to the complexity of computing the proposed measures
in conjunction with their predictive performance. As we
will demonstrate in Section ‘Experimental running time
analysis’, the alignment-free spectral methods generally
incur significant computational advantage over the

Page 8 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

competing alignment-based measures. This can be a
deciding factor when the methods are applied to large
barcode sets or in instances when new samples become
available and the (global) re-alignment is not desirable.
SVM-based classification
SVM-based classifiers are typically regarded as state-ofthe-art predictors across a wide span of modeling
problems. We therefore explore the use of this class of
models in the DNA barcode setting. Table 5 displays
cross-validation error rate of the SVM classifier on the
barcode sets in our study for the two alignment-free
scoring metrics of interest. The results demonstrate that
using SVM classifiers with alignment-free methods
results in similar performance compared to the previously examined nearest neighbor approach. We
observe slight but insignificant improvements in average
error rates for the spectrum method on ACG, Hesperiidae, and Astraptes data sets, e.g. error rate reduces from
1.07 to 0.86 on Astraptes data set. These results are not
unexpected, given the relatively large number of classes
(species) in these settings as well as the already low error
rates of the nearest neighbor predictor. At the same time,
the results suggest that the spectral scoring metric for
DNA barcodes appears to fairly accurately reflect the
sequence diversity within and between species, and is
not significantly affected (nor can be further shaped) by
the choice of the predictor/classifier algorithm. We
finally note that in our experiments which are not
reported here we observed that other measures, which
rely on global or local alignments such as the ones in
Section ‘Nearest neighbor approach’, are similarly not
affected by the choice of classification models.
Table 5: SVM 10-fold cross-validation error rate (%)

Dataset

spectrum (k = 10)

mismatch

ACG
Hesperiidae
Astraptes
Bats
Birds
Fish Australia
Fish larvae

2.32
3.25
0.86
1.63
5.99
5.35
2.86

3.48
3.36
1.07
1.67
7.09
5.35
5.71

Comparison with previously published results
We observe that alignment-free methods considerably
improve identification accuracy compared to the previously reported results of [18,20]. For example, on
Astraptes dataset [37], the test error rate of the multi-class
SVM is only 0.86% compared to 9% in [20] or 20% in
[18]. These results further signify the potential of the
proposed measures as applied to the barcoding-based
prediction task as well as to barcode analytics in general.
Barcode marker selection
DNA barcodes provide full-length barcode sequences for
barcode analytics. However, there are situations where
only certain (few) markers within the barcode may be
sufficient to accurately and rapidly perform the analytic
task. Species prediction based on barcodes, and in
particular for the case of a limited number of species,
is one such task. The use of markers instead of the full
sequence may increase the robustness of predictions by
eliminating the potentially irrelevant portions of the
barcodes that can also contain errors in barcode data
collection. Identification of sequence markers can be
also interesting from the perspective of further withinsequence loci analysis. Finally, the use of few markers
can also be advantageous from the computational
perspective. In this section, we evaluate the marker or
feature selection performance using alignment-free
methods.

In our experiments, we use the RELIEF [38] feature
selection algorithm to find subsets of discriminative
spectral markers. Using the k-mer or fragment notation
we introduced previously, the markers correspond to
those k-mers most relevant for species identification.
Table 6 displays error rates of the nearest neighbor
classifiers as a function of the number of selected
markers.
As evident from the table, using marker selection results
in the performance similar to that when full barcode
sequences are used. Even when only few (about 200500) markers are selected the alignment-free methods
still result in accurate prediction and perform on-par

Table 6: Feature selection performance using alignment-free methods (error, %)

Dataset
ACG
Hesperiidae
Astraptes
Bats of Guyana
Birds
Fish of Australia
Fish larvae

Full feature set (1048576 feat.)
2.49 ± 0.87
3.57 ± 1.08
1.07 ± 1.81
1.63 ± 1.22
6.30 ± 1.80
5.50 ± 3.27
2.86

4096
2.51
3.53
0.44
1.63
6.45
5.35

±
±
±
±
±
±
0

0.95
1.12
0.92
1.22
1.82
3.36

# features selected
2048
1024
2.79
3.80
0.44
1.63
6.94
5.35

±
±
±
±
±
±
0

1.02
1.22
0.92
1.22
2.08
3.36

3.00
4.17
0.44
1.63
7.13
6.14

±
±
±
±
±
±
0

0.96
1.05
0.92
1.22
2.05
3.50

512
3.17
4.40
0.44
1.63
7.41
6.80

±
±
±
±
±
±
0

0.86
1.15
0.92
1.22
1.77
3.15

200
3.52
4.81
0.64
1.63
9.10
8.32

±
±
±
±
±
±
0

0.64
1.30
1.03
1.22
1.64
2.75

100
4.48
5.64
1.49
1.63
9.84
9.51

±
±
±
±
±
±
0

0.86
1.20
1.75
1.22
1.99
2.40

Page 9 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

with alignment-based methods, while being computationally more efficient, as we show in Section Experimental running time analysis. Note that the number of
selected markers (e.g., 100) is the total number of marker
per set of all sequences and species. The average number
of markers per sequence is typically between 20% and
40% of the total number of markers (i.e., when top 500
markers are selected, each sequence is represented with
about 100-200 loci, a reduction of 70% to 85% from the
approximately 650 bases of the full barcode). It is also
interesting to note that selecting a smaller set of markers
instead of the full barcodes can sometimes lead to more
robust and accurate identification. For instance, in the
case of Fish larvae set the use of fewer features increases
the accuracy. One reason for this may be the presence of
distractors or sequencing errors that are eliminated when
only the most critical markers are selected.
Figures 5, 6, 7, 8, 9, 10 show, for various barcode sets,
the sequence-marker location maps for the top-100
spectrum features (highlighted in different colors). These
marker location maps display how the identified top
features are positioned within the barcodes. In the
figures, the vertical axis corresponds to individual
barcode sequences and the horizontal axis corresponds
to the position within the aligned (for visualization
purpose only) sequences. The blue horizontal lines in
the figures indicate species class boundaries, while the
color bars next to the maps indicate the color-to-marker
index correspondences. For completeness Tables 7, 8, 9,
10, 11, 12 show the corresponding top-100 spectrum
markers, ranked by the weights assigned by the feature
selection algorithm.

http://www.biomedcentral.com/1471-2105/10/S14/S9

Figure 6
Species sequence map for Astraptes data set (top 100
spectrum (k = 10) features).

Figure 7
Species sequence map for Bats of Guyana data set
(top 100 spectrum (k = 10) features).

Figure 5
Species sequence map for Hesperiidae data set (top
100 spectrum (k = 10) features).

The results indicate that different species classes have
distinct distributions (in terms of both spectrum marker
types and their locations) of the first few spectrum
markers (top 100 shown). This allows one to accurately
distinguish species between each other by solely using
the marker sets. As a consequence, these small sets of
features can serve as signatures for efficient and accurate
classification and identification, among the set of
considered species.

Page 10 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

Figure 8
Species sequence map for Birds of North America
data set (top 100 spectrum (k = 10) features).

Figure 9
Species sequence map for Fish of Australia data set
(top 100 spectrum (k = 10) features).

New species detection
In the classification task that we considered in previous
sections, a species label for a new barcode is predicted
according to the class (species) models learned from
training examples. In this section we consider the
problem of identifying whether a barcode belongs to a
species in the training set or to a new, unknown species.

We simulate the new species detection by holding out
barcode samples from one of the species in the barcode

http://www.biomedcentral.com/1471-2105/10/S14/S9

Figure 10
Species sequence map for Fish larvae data set (top
100 spectrum (k = 10) features).

dataset. Barcode samples belonging to this species are
then presented to the model that only contains barcodes
from the remaining “known” species. The query barcode
is labeled as a new species if its distance to the nearest
barcode in the “known species” set exceeds the average
distance between barcodes in the class of that closest
known species barcode. Otherwise, the query barcode is
assigned to the class of the closest known species. We
then measure the new species detection error rate by
holding out each species in the dataset and averaging the
individual species error rates. The average new species
detection error rates are reported in Table 13. The error
rates in Table 13 are, thus, the errors from assigning a
sample from held-out classes (i.e. new species) to the
existing train classes (known species). Table 14 shows
new species detection error rates in a slightly more
comprehensive but also more realistic task, where we
held-out not only the barcodes from the “unknown”
species but also some random barcodes from the known
species. Hence, the error rates in Table 14 include errors
from incorrectly assigning the “new species” label to the
barcode samples from one of the known classes but also
the errors from assigning the query barcode from new
species to one of the existing classes.
As we can see from the results, using the nearest
neighbor approach results in about 85-90% correct
identification of the samples belonging to new species.
To further investigate the errors committed here we show
a slightly more informative representation of the new
species detection results in Figure 11. The black curve in
each panel indicates the number of classes (vertical axis)
with the detection accuracy equal to or higher than the

Page 11 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

Table 7: Top-100 spectrum features for Hesperiidae data set

rank

feature

rank

feature

rank

feature

rank

feature

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25

TTATTATTAT
ATTATTATTA
TATTACCCCC
CCCCCTCTTT
AATTTTATTA
AGGAGCTATT
ATTGCCCATC
TTGCCCATCA
TTAGGAGCTC
TCAAATACCT
ACCTTTATTT
TAGGAGCTCC
ATTTTATTAC
GGAGCTATTA
ATTAGGAGCT
TATTGCCCAT
CAAATACCTT
TGCCCATCAA
AATACCTTTA
AAATACCTTT
CCCCTGATAT
GCCCCTGATA
CCCATCAAGG
CCCTGATATA
GCCCATCAAG

26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50

ATTAATATAC
CTTTCCCCCG
GCTTTCCCCC
TTAATATACG
TATTATAATT
AGCTTTCCCC
GCTCCTGATA
TAATTTTATT
CTCCTGATAT
TCCTGATATA
CTAATATTGC
TAGGAGCCCC
TGATCAAATA
TTAATTTTAT
TTTGATCAAA
TTGATCAAAT
CTTTATTTGT
CCTTTATTTG
TATTAATATA
ATTAATTTTA
TACCTTTATT
AATTTTTTCT
TATAGCTTTC
AGCCCCTGAT
ATACCTTTAT

51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75

TTTTTATAGT
TTTTTTATAG
ATTAATTTCA
TAATATACGA
GTTTATCCCC
TTTTTTTATA
CCTTCTTTAA
TGGAGATGAT
TTATTACCCC
TTTATCCCCC
CCCCTCTTTC
ATTTAGCAAT
GATTTAGCAA
TATTATTATT
AGGAGCTCCT
AATATTGCCC
ATATTGCCCA
ATTATTAATA
ATTATTACCC
TTATTAATAT
AGATGATCAA
GAGATGATCA
GGAGATGATC
TTTTATAGTT
TTACCCCCCT

76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100

GGAGCCCCTG
TATTAATTTC
AATATTGCTC
TTTTTGATCC
TTTTTTGATC
ATATTGCTCA
GAGCCCCTGA
ATTGCTCATC
TGCTCATCAA
TTGCTCATCA
ATTATTAATT
CTCATCAAGG
GCTCATCAAG
TACCCCCCTC
TAGCTTTCCC
ATATTAGGAG
TATTAGGAGC
TACTATTGTT
ATAGCTTTCC
CAATTATTAA
ACAATTATTA
TTTAGCAATT
CCCCCGAATA
TCCCCCGAAT
TTCCCCCGAA

Table 8: Top-100 spectrum features for Astraptes data set

rank

feature

rank

feature

rank

feature

rank

feature

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25

TATACCAACA
TTATACCAAC
TGAAAATGGA
AACTTCTTTA
ACTTCTTTAA
CTTCTTTAAG
CTTTAAGATT
TCTTTAAGAT
TTCTTTAAGA
TTTAAGATTA
GAACTTCTTT
GGAACTTCTT
TGGAACTTCT
AATCTTATAC
ACCAACACTT
ATACCAACAC
ATCTTATACC
CCAACACTTA
CTTATACCAA
TACCAACACT
TCTTATACCA
AATCTTATAT
ATATCAACAC
ATCAACACTT
ATCTTATATC

26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50

CTTATATCAA
TATATCAACA
TATCAACACT
TCAACACTTA
TCTTATATCA
TTATATCAAC
ACCCCCATCT
ATTACCCCCA
ATTATTACCC
TACCCCCATC
TATTACCCCC
TTACCCCCAT
TTATTACCCC
AATAATAGGT
AATAGGTGCC
AGGTGCCCCA
ATAGGTGCCC
GGTGCCCCAG
GTGCCCCAGA
TAGGTGCCCC
TTGATTATTA
TGGAGGATTT
TGCCCCAGAT
AAAATGGAGC
AAATGGAGCT

51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75

AATGGAGCTG
ATGGAGCTGG
GAAAATGGAG
AATATACGAA
ATATACGAAT
ATTAATATAC
TAATATACGA
TATACGAATT
TATTAATATA
TTAATATACG
AAAATGGGGC
AAATGGGGCT
AATGGGGCTG
ATGGGGCTGG
GAAAATGGGG
GGCTGGTACA
GGGCTGGTAC
GGGGCTGGTA
TGAAAATGGG
TGGGGCTGGT
AGGAGACCCA
AGGAGGAGAC
GAGACCCAAT
GAGGAGACCC
GGAGACCCAA

76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100

GGAGGAGACC
ATCTTGCCGG
CATCTTGCCG
TCATCTTGCC
CCGGTATTTC
CGGTATTTCA
CTTGCCGGTA
GCCGGTATTT
TCTTGCCGGT
TGCCGGTATT
TTGCCGGTAT
ATACGAATTA
TACGAATTAA
ACGAATTAAT
AATATGCGAA
ATATGCGAAT
ATGCGAATTA
ATTAATATGC
GCGAATTAAT
TAATATGCGA
TATGCGAATT
TATTAATATG
TGCGAATTAA
TTAATATGCG
AATTGGAGGA

Page 12 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

Table 9: Top-100 spectrum features for Bats of Guyana data set

rank

feature

rank

feature

rank

feature

rank

feature

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25

ATAATTGGAG
TTGTAATAAT
TTTGTAATAA
ATAAGCTTCT
TAAGCTTCTG
GTCCTAGCAG
TCCTAGCAGC
CAACACTTAT
CCTAGCAGCA
AATATAAGCT
ATATAAGCTT
CTTCCTGTCC
TTCCTGTCCT
AAGCTTCTGA
TCTTCCTGTT
ACAGCTCATG
CAGCTCATGC
AACACTTATT
CTTCTGACTC
TAGTAGGCAC
ACAGCCCATG
CAGCCCATGC
AATATAAAAC
ATATAAAACC
TCTAGCAGCA

26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50

AGCTTCTGAC
CCTGTCCTAG
CTGTCCTAGC
GCTTCTGACT
GTTCTAGCAG
TGTCCTAGCA
TTCTAGCAGC
TCCTGTCCTA
ATAGTAGGCA
GTAACAGCTC
TAACAGCTCA
AACAGCTCAT
ATCATAATTG
ATCAACACTT
TATCAACACT
TCAACACTTA
TCATAATTGG
ATATCAAACA
GAAGCAGGAG
CTTCCTGTTC
TAATTGGAGG
TTCCTGTTCT
AGTAGGCACT
TCCCCGAATA
TTCCCCGAAT

51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75

TTTCCCCGAA
GTCTTATTAC
TCTTATTACT
AGCCCATGCC
TTATTACTAC
CCCATGCCTT
GCCCATGCCT
TTATAATTGG
ATTATAATTG
TATAATTGGA
AACAGCCCAT
TACCTATTAT
CCTGTTCTAG
CTGTTCTAGC
TATTAATATA
TTTATTACTA
ATCAAACACC
ATTAGGTGAT
CCTTTGTAAT
GCCTTTGTAA
TATCAAACAC
TCCTATTACT
CATAATTGGA
GAGCTATTAA
GGAGCTATTA

76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100

GTAACAGCCC
TAACAGCCCA
TGTTCTAGCA
ATCACTATAC
TCACTATACT
AAGCAGGAGT
CACTATACTA
ACACTTATTC
CCTAGCAGGC
AAACCTTAAT
AACCTTAATA
ACCTTAATAC
TATTAGGTGA
CCCCGAATAA
CCCGAATAAA
TCTGACTCCT
TTCTGACTCC
TTTTATTACT
AGGTATCACT
CTCAATATCA
GGTATCACTA
GTAATAATTT
GTATCACTAT
TAATAATTTT
TCAATATCAA

Table 10: Top-100 spectrum features for Birds of North America data set

rank

feature

rank

feature

rank

feature

rank

feature

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25

ATCACAATAC
ATAATCGGAG
ACCAACACCT
TACCAACACC
AAGCTTCTGA
AACATAAGCT
ACATAAGCTT
CATAAGCTTC
TCCTACTCCT
CCCCTATTCG
TTCTTCGACC
CCCTATTCGT
TCTTCGACCC
GCCTTCGTAA
CCTTCGTAAT
CTTCGTAATA
AGCTTCTGAC
GCTTCTGACT
GAGCCTCAGT
GGAGCCTCAG
CAACATAAAA
TCACAATACC
TCCTCCTACT
CACAATACCA
TCAACATAAA

26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50

ACTTCATCAC
AACCTAGCCC
AACTTCATCA
ACCTAGCCCA
ATCAACATAA
ATCAACTTCA
TCAACTTCAT
ATACCAAACC
CTAATCACTG
CTCACAATAC
ATAAGCTTCT
TAAGCTTCTG
TCGTAATAAT
CAACATAAGC
GCAACCTAGC
GGCAACCTAG
TAATCACTGC
AATACCAAAC
CAATACCAAA
ATAATTGGAG
TTCGTAATAA
ACCAAACCCC
TACCAAACCC
CATAGCATTC
TCTCACAATA

51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75

AAACAACATA
ACAACATAAG
ATTCTTCGAC
AACTGACTAG
ACTGACTAGT
AACAACATAA
AGCAATCAAC
CAACTTCATC
GGAGGAGACC
CTCTCACAAT
ACAATACCAA
ACGCCGGAGC
CACGCCGGAG
GTCCTAATCA
TCCTAATCAC
TGATTCTTTG
TCCTCCTCCT
GAGGAGACCC
ACATAGCATT
GACATAGCAT
CAGTAGACCT
TCAGTAGACC
TTCTGATTCT
TCTGATTCTT
CATAAAACCC

76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100

GATTCTTTGG
TATACCAACA
TAGCATTCCC
ATAGCATTCC
CGGAGCCTCA
AGACGACCAA
CATGCCTTCG
GTAGACCTAG
TAGACCTAGC
ACCCCCCTAT
CCCCCCTATT
AACCCCCCTA
ATGCCTTCGT
TCATCACAAC
TTCATCACAA
AAACTGACTA
ATCTTCTCCC
TCTTCTCCCT
AAACCCCCCT
CAAACCCCCC
AACCTAAACA
ACCTAAACAC
CGTAATAATC
ATCGGAGGAT
TAATCTTCTT

corresponding value on the horizontal axis, for each of
the barcode datasets. For example, in the ACG set there
are about 480 species that can be predicted with the
accuracy of 90% or higher. The performance of an ideal

method would result in the horizontal solid-red line. In
all cases, performance of the spectrum method relatively
closely follows the ideal method. Majority of incorrect
assignments occur on very few species, which is evident

Page 13 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

Table 11: Top-100 spectrum features for Fish of Australia data set

rank

feature

rank

feature

rank

feature

rank

feature

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25

AACATAAAAC
ACATAAAACC
ATTATTAACA
TTATTAACAT
TAACATAAAA
ATTAACATAA
TTAACATAAA
TCCTTCTCCT
ATTATTAATA
TTATTAATAT
TATTAACATA
GAACAGTTTA
TGAACAGTTT
GAGGAGACCC
GGAGGAGACC
TGACTTCTTC
ATCAAACACC
TATCAAACAC
TTCTTCTCCT
AATATAAAAC
ATATAAAACC
CGAATAAATA
GAATAAATAA
TCTTTGACCC
TTCTTTGACC

26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50

GACTTCTTCC
TAATAATTGG
AACATAAGCT
ACATAAGCTT
AATATCAAAC
CAATATCAAA
TTATGATTGG
ACCAACACCT
TACCAACACC
TTATTACAAC
GAGACCCAAT
GGAGACCCAA
TTTATTACAA
ATACCAATTA
CTTTACCAAC
GGAGGAGGAG
TACCAATTAT
TTTACCAACA
AACAGTCTAC
ACAGACCGAA
CAGACCGAAA
GAACAGTCTA
TGAACAGTCT
ATAATTGGTG
TCCTTCTTCT

51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75

ACAGTCTACC
CAGTCTACCC
TAAATAATAT
AGCTTCTGAC
CATAAAACCC
CCCCGAATAA
CCCGAATAAA
GCTTCTGACT
TAGTAATACC
TCATGATTGG
CCTCGAATAA
CTCGAATAAA
CTTCTTCTCC
AATACCAAAC
CAATACCAAA
GAGGAGGAGA
ATGAGCTTCT
ATGATTGGAG
TGAGCTTCTG
TTATGATCGG
ATAAATAATA
TTACCAACAC
TTTCCTCAAT
ATATCAAACA
ATAATTGGAG

76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100

ATCTTCTCCC
TCTTCTCCCT
ACTATTATTA
TATTATTAAC
ATAGTAATAC
AGGAGACCCA
CTATTATTAA
TAATATAAAA
TTAATATAAA
TTGACCCTGC
AATAAACAAC
AATTTTATTA
ATTACAATGC
ATTTTATTAC
TTACAATGCT
TTGGAAACTG
TTTGACCCTG
TTTGGAAACT
AATAAATAAT
ATTAATATAA
GAGGGGACCC
GGAGGGGACC
AATATGAGCT
ACCCTGCAGG
AGACCGAAAC

Table 12: Top-100 spectrum features for Fish larvae data set

rank

feature

rank

feature

rank

feature

rank

feature

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25

CGCAATCCTC
GCAATCCTCT
GCGCAATCCT
ATCAACGAAC
CGCAATCCCC
GATCAACGAA
GCAATCCCCT
GCGCAATCCC
TCAACGAACC
ACCCTAGGGA
AGTTACCCTA
CCCTAGGGAT
CCTAGGGATA
CGATCAACGA
GTTACCCTAG
TACCCTAGGG
TTACCCTAGG
TCTGACCAAT
TTTCAAGTCA
CTGACCAAAA
TCTGACCAAA
AAACTAAGAG
AACCCCCATG
ACCCCCATGT
CAGTCAATGA

26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50

CCAGTCAATG
CCCATGTGGA
CCCCATGTGG
CCCCCATGTG
CCCCGTGCAG
CTCCCCGTGC
TCCAGTCAAT
TCCCCGTGCA
TGACCAAAAA
AAAAGATCCG
AAACAGAATT
AAAGATCCGG
AAAGGATTGA
AAAGTGGATC
AAATAAAGGA
AAATAACCCC
AACAAGATGG
AACCCACCCT
AACGGACCTA
AACTCTAATA
AAGATGGAAC
AAGCGGGGAT
AAGGATTGAA
AAGTGGATCA
AATAAACAGA

51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75

AATAAAGGAT
AATAAATAAC
AATAACCCCC
AATGACCCTA
AATTGATCTC
ACAACTCTAA
ACAAGATGGA
ACACTAAAGT
ACAGCTGAGA
ACCCACCCTG
ACCCCTCCTA
ACCCTGATGT
ACCTAGTTAC
ACGGACCTAG
ACTAAAGTGG
ACTCTAATAA
AGAAGCGGGG
AGACACTAAA
AGAGTCCATA
AGAGTTACAA
AGATGGAACC
AGCGGGGATT
AGCTGAGAGT
AGGATTGAAC
AGTCCATATC

76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100

AGTGGATCAT
AGTTACAACT
ATAAACAGAA
ATAAAGGATT
ATAAATAACC
ATAACCCCCA
ATCAACGGAC
ATCATGTCAA
ATCCTCTTTT
ATCGACGAGG
ATCTCCCCGT
ATGACCCTAA
ATGGAACCCA
ATGTCAATGA
ATGTGGAATG
ATTGAACAAG
ATTGATCTCC
CAACGGACCT
CAACTCTAAT
CAAGATGGAA
CAATCCCCTC
CAATCCTCTT
CAATGACCCT
CACCCCTCCT
CACCCTGATG

from the sudden initial drops in the curves. We observe
that incorrect assignments of the samples from new
species to the existing classes often resulted from the
presence of the (nearly) duplicate sequences in the

training set. For instance, in the Astraptes dataset, query
sequences from SENNOV were closest to an identical
sequence which is also present in the YESENN species.
This points to the need for alternative sources of

Page 14 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

Table 13: New species detection (average per-class error, %)

Dataset

error

# classes with 0% error

ACG
Hesperiidae
Astraptes
Bats of Guyana
Birds of North America
Fish of Australia

14.12
17.53
7.81
5.80
16.36
16.21

474/573
288/364
10/12
90/96
524/656
174/211

Table 14: New species detection (average error rate, %)

Dataset

Error

ACG
Hesperiidae
Astraptes
Bats of Guyana
Birds of North America
Fish of Australia
Fish larvae

10.29
10.88
8.47
9.95
15.54
14.92
15.77

information in cases where the barcodes may not be
sufficient to discriminate among species but also to the
need for additional curation in some of the datasets.

Barcode clustering
In this section, we consider the problem of arranging
barcode sequences into groups (clusters) to establish
relationships between sequences and automatically discover class structure. Clustering can be useful for putative
samples with no prior evidence of species assignments.
Clustering-based evaluation also allows one to eliminate
the influence of the classification training (weight estimation) process, which is an additional factor that affects the
classification performance. As a consequence, clustering
may provide a more direct insight into the quality of the
similarity measure alone.

To evaluate the results of clustering we compare the
partitioning obtained by the clustering model with the
partitioning given by the known species membership. We
perform clustering experiments using the recently proposed
affinity propagation algorithm [39] which makes use of the
computed similarity scores. We report clustering results
using the alignment-free methods only in Table 15, in the
light of the classification results which we presented earlier
across different similarity metrics. As we can see from the
table, clustering of barcode datasets results in accurate
partitioning of the barcodes into groups that are similar to

Figure 11
New species detection performance.

Page 15 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

Table 15: Clustering results (using spectrum similarity measure)

Dataset
ACG
Hesperiidae
Astraptes
Bats
Birds
Fish Australia
Fish larvae

#clusters

error, %

Rand index

Jaccard index

644
382
17
98
650
235
7

2.84
4.44
1.51
0.95
5.25
2.52
2.86

99.85
99.79
95.59
99.21
99.90
99.94
98.66

83.96
86.42
81.59
86.58
86.59
93.07
95.51

the true species-induced classes. We use Rand [40] and
Jaccard indices to evaluate the clustering quality. Rand = (a +
d)/T, Jaccard = a/(a + b + c), where a is the number pairs with
the same class label assigned to the same cluster, b is the
number of points with the same class label assigned to
different clusters, c is the number of pairs with different class
labels placed into the same cluster, d is the number of pairs
with different labels placed into different clusters, and T is
the total number of pairs.
To further illustrate the clustering results, we show in
Figure 12 projections of the barcode data onto a 2D
plane. We note the agreement of species labels and
proximities in the embedded space. This suggests
possibility of using clustering with alignment-free
methods as an efficient and accurate tool for exploratory
analysis of newly obtained barcodes.
Experimental running time analysis
Computational complexity of evaluating similarity on
large sets of barcodes may be a prominent factor in

practical barcoding applications. We evaluate the computational speed of different methods by measuring
running time for computing similarity scores among all
pairs of sequences in a barcode dataset. The running
times are obtained by running the optimized versions of
all targeted methods on a single 3.0 GHz quad core CPU
using 2 GB RAM (Dell PowerEdge 2950). Table 16
compares running times for the alignment-free kernel
methods as well as PSI-BLAST and alignment-based
(Smith-Waterman) methods. As we can see from the
table, alignment-free kernel methods are significantly
faster compared to computationally demanding alignment-based (Smith-Waterman) methods. For example, it
takes about 60 seconds to evaluate 4267-by-4267
similarity matrix using the spectrum method compared
to 64800 seconds (18 h) for computing the SmithWaterman scoring matrix. These results are not surprising given the complexity analysis mentioned in Section
‘Methods’ and further studied in [31]. The low computational complexity of the alignment-free scores, besides
its appeal for analytics on large datasets, also opens the

Figure 12
Clustering results for barcode sequences using alignment-free spectrum method (data is projected onto
2D plane).

Page 16 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

http://www.biomedcentral.com/1471-2105/10/S14/S9

Table 16: Running time (kernel computation), s

Dataset

PSI-BLAST

Smith-Waterman

spectrum (k = 10)

mismatch

ACG
Hesperiidae
Astraptes
Bats
Birds
Fish Australia
Fish larvae

2557
891
99
239
1147
203
1.9

64818
19378
854
2818
27311
3424
39.58

60.328
16.16
0.89
1.91
18.75
1.57
0.23

366.39
90.26
2.15
12.12
149.67
9.95
0.16

possibility for using these metrics on conceptualized
handheld barcode scanners that may be designed in the
future.

Conclusion
In this work we demonstrate that newly developed
alignment-free methods can serve as efficient and
accurate analytical tools for DNA barcoding problems.
The new alignment-free methods provide highly accurate
and computationally efficient identification and classification of barcode sequences as we show on a set of
various barcode collections. Using new alignment-free
scoring approaches demonstrates excellent performance
in comparison with more computationally demanding,
traditional alignment-based methods. The use of alignment-free scoring methods allows discovery of natural
groups (clusters) in barcode collections that accurately
reflect the species-based groupings. This reflects potentially high agreement between the proposed fragmentinduced sequence similarity measures and the within
and across species barcode diversity. Finally, we show
that the spectral methods also foster discovery of withinbarcode markers that point to critical differences among
barcodes of different sample groups. These markers can
serve both as the sparse and robust barcode codes and as
possible pointers to within barcode loci that deserve
further investigation. Our experiments finally suggest
that it may be possible to further improve the
performance of our spectral scores by merging them
with the position-based metrics, such as the Kimura
distance. Currently, the spectral kernels rely on the 0/1
scoring within each fragment. While implementing
Kimura scoring within k-mers is possible, a direct
implementation adversely affects the spectral algorithm’s
efficiency, with the complexity becoming quadratic in
the sequence length. This leaves open an avenue for
future research into efficient spectral barcoding algorithms for arbitrary fragment scores.

Acknowledgements
This article has been published as part of BMC Bioinformatics Volume 10
Supplement 14, 2009: Biodiversity Informatics. The full contents of the
supplement are available online at http://www.biomedcentral.com/14712105/10?issue=S14.

References
1.
2.
3.

4.
5.
6.
7.
8.
9.

10.

11.

12.
13.
14.
15.
16.

Competing interests
The authors declare that they have no competing interests.

Authors’ contributions
All authors contributed equally to this work.

17.
18.

Hebert PDN, Cywinska A, Ball S and deWaard J: Biological
identifications through DNA barcodes. Proceedings of the Royal
Society of London 2003, 313–322.
Stoeckle M and Herbert PDN: Barcode of Life. Scientific American
2008, 82–88.
Linares M, Soto-Calderón I, Lees D and Anthony N: High
mitochondrial diversity in geographically widespread butterflies of Madagascar: A test of the DNA barcoding
approach. Mol Phylogenet Evol 2008.
Armstrong KF and Ball SL: DNA barcodes for biosecurity:
invasive species identification. Philos Trans R Soc Lond, B, Biol Sci
2005, 360(1462):1813–23.
Smith P, McVeagh S, Steinke D and Meyer A: DNA barcoding for
the identification of smoked fish products. Journal of Fish Biology
2008.
Wong E and Hanner R: DNA barcoding detects market
substitution in North American seafood. Food Research
International 2008.
Holmes B, Steinke D and Ward R: Identification of shark and ray
fins using DNA barcoding. Fisheries Research 2008.
Saunders G: Applying DNA barcoding to red macroalgae: a
preliminary appraisal holds promise for future .... Philosophical
Transactions of the Royal Society B: ... 2005.
Sogin ML, Morrison HG, Huber JA, Welch DM, Huse SM, Neal PR,
Arrieta JM and Herndl GJ: Microbial diversity in the deep sea
and the underexplored “rare biosphere". Proceedings of the
National Academy of Sciences 2006, 103(32):12115–12120 http://
www.pnas.org/content/103/32/12115.abstract.
Kress W, Wurdack K, Zimmer E and Weigt L: Use of DNA
barcodes to identify flowering plants. Proceedings of the National
Academy of Sciences 2005 http://www.pnas.org/cgi/content/abstract/
102/23/8369.
Chase MW, Salamin N, Wilkinson M, Dunwell JM, Kesanakurthi RP,
Haidar N and Savolainen V: Land plants and DNA barcodes:
short-term and long-term goals. Philos Trans R Soc Lond, B, Biol
Sci 2005, 360(1462):1889–95.
Kress WJ and Erickson DL: DNA Barcoding–a Windfall for
Tropical Biology?. BIOTROPICA 2008.
Barrett R and Hebert P: Identifying spiders through DNA
barcodes. Can J Zool 2005, 83(3):481–491.
Ward RD, Zemlak TS, Innes BH, Last PR and Hebert PD: DNA
barcoding Australia’s fish species. Philosophical Transactions of
the Royal Society B: Biological Sciences 2005, 360(1462):1847–1857.
Robins J, Hingston M, Matisoo-Smith E and Ross H: Identifying
Rattus species using mitochondrial DNA. Molecular Ecology
Notes 2007.
Steinke D, Vences M, Salzburger W and Meyer A: TaxI: a software
tool for DNA barcoding using distance methods. Philosophical
Transactions of the Royal Society B: Biological Sciences 2005, 360
(1462):1975–1980.
Abdo Z and Golding GB: A step toward barcoding life: a modelbased, decision-theoretic method to assign genes to preexisting species groups. Systematic Biology 2007, 56:44–56.
Nielsen R and Matz M: Statistical Approaches for DNA
Barcoding. Systematic Biology 2006, 55:162–169.

Page 17 of 18
(page number not for citation purposes)

BMC Bioinformatics 2009, 10(Suppl 14):S9

19.
20.

21.
22.
23.
24.

25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.
37.

38.

39.
40.

http://www.biomedcentral.com/1471-2105/10/S14/S9

Zhang A: Inferring Species Membership Using DNA
Sequences with Back-Propagation Neural Networks.
Systematic Biology 2008.
Matz MV and Nielsen R: A likelihood ratio test for species
membership based on DNA sequence data. Philosophical
Transactions of the Royal Society B: Biological Sciences 2005, 360
(1462):1969–1974.
Meyer CP and Paulay G: DNA barcoding: error rates based on
comprehensive sampling. PLoS Biol 2005, 3(12):.
Leslie CS, Eskin E and Noble WS: The Spectrum Kernel: A
String Kernel for SVM Protein Classification. Pacific Symposium
on Biocomputing 2002, 566–575.
Leslie CS, Eskin E, Weston J and Noble WS: Mismatch String
Kernels for SVM Protein Classification. NIPS MIT Press: Becker
S, Thrun S, Obermayer K 2002, 1417–1424.
Kuang R, Ie E, Wang K, Wang K, Siddiqi M, Freund Y and Leslie C:
Profile-Based String Kernels for Remote Homology Detection and Motif Extraction. CSB ‘04: Proceedings of the 2004 IEEE
Computational Systems Bioinformatics Conference (CSB’04) Washington,
DC, USA: IEEE Computer Society; 2004, 152–160.
Jaakkola T, Diekhans M and Haussler D: A Discriminative
Framework for Detecting Remote Protein Homologies.
Journal of Computational Biology 2000, 7(1-2):95–114.
Menchetti S, Costa F and Frasconi P: Weighted decomposition
kernels. ICML ‘05: Proceedings of the 22nd international conference on
Machine learning New York, NY, USA: ACM Press; 2005, 585–592.
Schölkopf B and Smola AJ: Learning with kernels MIT Press; 2002.
Vapnik V: Statistical learning theory Wiley; 1998.
Leslie CS, Eskin E, Weston J and Noble WS: Mismatch String
Kernels for SVM Protein Classification. NIPS 2002, 1417–1424.
Leslie C and Kuang R: Fast String Kernels using Inexact
Matching for Protein Sequences. J Mach Learn Res 2004,
5:1435–1455.
Kuksa P, Huang PH and Pavlovic V: Scalable Algorithms for
String Kernels with Inexact Matching. NIPS 2008.
Allwein EL, Schapire RE and Singer Y: Reducing multiclass to
binary: a unifying approach for margin classifiers. J Mach Learn
Res 2001, 1:113–141.
http://www.boldsystems.org.
http://dimacs.rutgers.edu/Workshops/BarcodeResearchChallenges2007/.
http://www.kyb.tuebingen.mpg.de/bs/people/spider.
http://seqam.rutgers.edu/projects/bioinfo/barcoding/barcoding.html.
Hebert PDN, Penton EH, Burns JM, Janzen DH and Hallwachs W:
Ten species in one: DNA barcoding reveals cryptic species in
the neotropical skipper butterfly Astraptes fulgerator. PNAS
2004, 101:14812–14817.
Kononenko I: Estimating attributes: analysis and extensions of
RELIEF. ECML-94: Proceedings of the European conference on machine
learning on Machine Learning Secaucus, NJ, USA: Springer-Verlag New
York, Inc; 1994, 171–182.
Frey BJ and Dueck D: Clustering by Passing Messages Between
Data Points. Science 2007, 315:972–976 http://www.psi.toronto.
edu/affinitypropagation.
Rand WM: Objective Criteria for the Evaluation of Clustering
Methods. Journal of the American Statistical Association 1971, 66
(336):846–850 http://www.jstor.org/stable/2284239.

Publish with Bio Med Central and every
scientist can read your work free of charge
"BioMed Central will be the most significant development for
disseminating the results of biomedical researc h in our lifetime."
Sir Paul Nurse, Cancer Research UK

Your research papers will be:
available free of charge to the entire biomedical community
peer reviewed and published immediately upon acceptance
cited in PubMed and archived on PubMed Central
yours — you keep the copyright

BioMedcentral

Submit your manuscript here:
http://www.biomedcentral.com/info/publishing_adv.asp

Page 18 of 18
(page number not for citation purposes)

</pre>
</body>
</html>
